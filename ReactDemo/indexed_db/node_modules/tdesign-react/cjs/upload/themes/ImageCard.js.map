{"version":3,"file":"ImageCard.js","sources":["../../../src/upload/themes/ImageCard.tsx"],"sourcesContent":["import React, { MouseEvent } from 'react';\nimport { BrowseIcon as TdBrowseIcon, DeleteIcon as TdDeleteIcon, AddIcon as TdAddIcon } from 'tdesign-icons-react';\nimport classNames from 'classnames';\nimport Loading from '../../loading';\nimport useGlobalIcon from '../../hooks/useGlobalIcon';\nimport ImageViewer from '../../image-viewer';\nimport { CommonDisplayFileProps } from '../interface';\nimport { TdUploadProps, UploadFile } from '../type';\n\nexport interface ImageCardUploadProps extends CommonDisplayFileProps {\n  multiple: TdUploadProps['multiple'];\n  max: TdUploadProps['max'];\n  disabled?: TdUploadProps['disabled'];\n  showUploadProgress: TdUploadProps['showUploadProgress'];\n  triggerUpload?: () => void;\n  uploadFiles?: (toFiles?: UploadFile[]) => void;\n  cancelUpload?: (context: { e: MouseEvent<HTMLElement>; file: UploadFile }) => void;\n  onPreview?: TdUploadProps['onPreview'];\n}\n\nconst ImageCard = (props: ImageCardUploadProps) => {\n  const { displayFiles, locale, classPrefix, multiple, max = 0, onRemove, showUploadProgress, disabled } = props;\n  const { BrowseIcon, DeleteIcon, AddIcon } = useGlobalIcon({\n    AddIcon: TdAddIcon,\n    BrowseIcon: TdBrowseIcon,\n    DeleteIcon: TdDeleteIcon,\n  });\n\n  const showTrigger = React.useMemo(() => {\n    if (multiple) {\n      return !max || displayFiles.length < max;\n    }\n    return !displayFiles?.[0];\n  }, [displayFiles, max, multiple]);\n\n  const renderMainContent = (file: UploadFile, index: number) => (\n    <div className={`${classPrefix}-upload__card-content ${classPrefix}-upload__card-box`}>\n      <img className={`${classPrefix}-upload__card-image`} src={file.url} />\n      <div className={`${classPrefix}-upload__card-mask`}>\n        <span className={`${classPrefix}-upload__card-mask-item`} onClick={(e) => e.stopPropagation()}>\n          <ImageViewer\n            trigger={({ onOpen }) => (\n              <BrowseIcon\n                onClick={(e) => {\n                  props.onPreview?.({ file, index, e });\n                  onOpen();\n                }}\n              />\n            )}\n            images={displayFiles.map((t) => t.url)}\n            defaultIndex={index}\n          />\n        </span>\n        {!disabled && (\n          <>\n            <span className={`${classPrefix}-upload__card-mask-item-divider`} />\n            <span className={`${classPrefix}-upload__card-mask-item`} onClick={(e) => e.stopPropagation()}>\n              <DeleteIcon onClick={(e) => onRemove?.({ e, file, index })} />\n            </span>\n          </>\n        )}\n      </div>\n    </div>\n  );\n\n  const cardItemClasses = `${classPrefix}-upload__card-item ${classPrefix}-is-background`;\n  return (\n    <div>\n      <ul className={`${classPrefix}-upload__card`}>\n        {displayFiles?.map((file, index) => {\n          if (file.status === 'progress') {\n            return (\n              <li className={cardItemClasses} key={file.name + index}>\n                <div className={`${classPrefix}-upload__card-container ${classPrefix}-upload__card-box`}>\n                  <Loading\n                    loading={true}\n                    size=\"medium\"\n                    text={\n                      <p>\n                        {locale?.progress?.uploadingText}\n                        {showUploadProgress ? `${file.percent}%` : ''}\n                      </p>\n                    }\n                  />\n                </div>\n              </li>\n            );\n          }\n          return (\n            <li className={cardItemClasses} key={file.name + index}>\n              {renderMainContent(file, index)}\n            </li>\n          );\n        })}\n        {showTrigger && (\n          <li className={cardItemClasses} onClick={props.triggerUpload}>\n            <div className={`${classPrefix}-upload__card-container ${classPrefix}-upload__card-box`}>\n              <AddIcon />\n              <p className={`${classPrefix}-size-s`}>{locale?.triggerUploadText?.image}</p>\n            </div>\n          </li>\n        )}\n      </ul>\n\n      {props.tips && <small className={classNames(props.tipsClasses)}>{props.tips}</small>}\n    </div>\n  );\n};\n\nImageCard.displayName = 'ImageCard';\n\nexport default ImageCard;\n"],"names":["ImageCard","props","displayFiles","locale","classPrefix","multiple","max","onRemove","showUploadProgress","disabled","useGlobalIcon","AddIcon","TdAddIcon","BrowseIcon","TdBrowseIcon","DeleteIcon","TdDeleteIcon","showTrigger","React","useMemo","length","renderMainContent","file","index","createElement","className","src","url","onClick","e","stopPropagation","ImageViewer","trigger","onOpen","onPreview","images","map","t","defaultIndex","cardItemClasses","status","key","name","Loading","loading","size","text","progress","uploadingText","percent","triggerUpload","triggerUploadText","image","tips","classNames","tipsClasses","displayName"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoBA,IAAMA,SAAA,GAAY,SAAZA,SAAY,CAACC,KAAD,EAAiC;AAAA,EAAA,IAAA,qBAAA,CAAA;;AAC3C,EAAA,IAAEC,YAAF,GAAmGD,KAAnG,CAAEC,YAAF;AAAA,MAAgBC,MAAhB,GAAmGF,KAAnG,CAAgBE,MAAhB;AAAA,MAAwBC,WAAxB,GAAmGH,KAAnG,CAAwBG,WAAxB;AAAA,MAAqCC,QAArC,GAAmGJ,KAAnG,CAAqCI,QAArC;MAAmGJ,UAAAA,GAAAA,KAAnG,CAA+CK,GAA/C;MAA+CA,GAA/C,2BAAqD,CAArD,GAAA,UAAA;AAAA,MAAwDC,QAAxD,GAAmGN,KAAnG,CAAwDM,QAAxD;AAAA,MAAkEC,kBAAlE,GAAmGP,KAAnG,CAAkEO,kBAAlE;AAAA,MAAsFC,QAAtF,GAAmGR,KAAnG,CAAsFQ,QAAtF,CAAA;;AACN,EAAA,IAAA,cAAA,GAA4CC,8BAAc,CAAA;AACxDC,IAAAA,OAAS,EAAAC,yBAD+C;AAExDC,IAAAA,UAAY,EAAAC,4BAF4C;AAGxDC,IAAAA,UAAY,EAAAC,4BAAAA;AAH4C,GAAA,CAA1D;MAAQH,UAAR,kBAAQA,UAAR;MAAoBE,UAApB,kBAAoBA,UAApB;MAAgCJ,OAAhC,kBAAgCA,OAAhC,CAAA;;AAMM,EAAA,IAAAM,WAAA,GAAcC,yBAAM,CAAAC,OAAN,CAAc,YAAM;AACtC,IAAA,IAAId,QAAJ,EAAc;AACL,MAAA,OAAA,CAACC,GAAD,IAAQJ,YAAA,CAAakB,MAAb,GAAsBd,GAA9B,CAAA;AACT,KAAA;;IACA,OAAO,EAACJ,YAAD,KAACA,IAAAA,IAAAA,YAAD,eAACA,YAAe,CAAA,CAAA,CAAhB,CAAP,CAAA;GAJkB,EAKjB,CAACA,YAAD,EAAeI,GAAf,EAAoBD,QAApB,CALiB,CAAd,CAAA;;AAON,EAAA,IAAMgB,iBAAoB,GAAA,SAApBA,iBAAoB,CAACC,IAAD,EAAmBC,KAAnB,EAAA;AAAA,IAAA,sBACvBL,yBAAA,CAAAM,aAAA,CAAA,KAAA,EAAA;MAAIC,SAAA,EAAA,EAAA,CAAA,MAAA,CAAcrB,WAAd,EAAA,wBAAA,CAAA,CAAA,MAAA,CAAkDA,WAAlD,EAAA,mBAAA,CAAA;AAAJ,KAAA,iBACEc,yBAAA,CAAAM,aAAA,CAAA,KAAA,EAAA;MAAIC,qBAAcrB,aAAlB,qBAAA,CAAA;MAAoDsB,KAAKJ,IAAK,CAAAK,GAAAA;KAA9D,CADF,iBAEET,yBAAA,CAAAM,aAAA,CAAA,KAAA,EAAA;AAAIC,MAAAA,qBAAcrB;AAAlB,KAAA,iBACEc,yBAAA,CAAAM,aAAA,CAAA,MAAA,EAAA;MAAKC,qBAAcrB,aAAnB,yBAAA,CAAA;MAAyDwB,OAAS,EAAA,iBAACC,CAAD,EAAA;QAAA,OAAOA,CAAA,CAAEC,eAAF,EAAP,CAAA;AAAA,OAAA;AAAlE,KAAA,iBACEZ,yBAAA,CAAAM,aAAA,CAAAO,6BAAA,EAAA;AACCC,MAAAA,OAAS,EAAA,SAAA,OAAA,CAAA,IAAA,EAAA;QAAA,IAAGC,MAAH,QAAGA,MAAH,CAAA;AAAA,QAAA,sBACNf,yBAAA,CAAAM,aAAA,CAAAX,UAAA,EAAA;UACCe,OAAA,EAAS,SAACC,OAAAA,CAAAA,CAAD,EAAO;AAAA,YAAA,IAAA,gBAAA,CAAA;;AACd,YAAA,CAAA,gBAAA,GAAA5B,KAAA,CAAMiC,SAAN,MAAA,IAAA,IAAA,gBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,gBAAA,CAAA,IAAA,CAAAjC,KAAA,EAAkB;AAAEqB,cAAAA,IAAM,EAANA,IAAF;AAAQC,cAAAA,KAAA,EAAAA,KAAR;AAAeM,cAAAA,GAAAA,CAAAA;AAAf,aAAlB,CAAA,CAAA;YACOI,MAAA,EAAA,CAAA;AACT,WAAA;AAJD,SAAA,CADM,CAAA;OADV;AASCE,MAAAA,QAAQjC,YAAa,CAAAkC,GAAb,CAAiB,UAACC,CAAD,EAAA;QAAA,OAAOA,EAAEV,GAAT,CAAA;AAAA,OAAjB,CATT;AAUCW,MAAAA,YAAc,EAAAf,KAAAA;KAVf,CADF,CADF,EAeE,CAACd,QAAD,oHAEIS,yBAAA,CAAAM,aAAA,CAAA,MAAA,EAAA;AAAKC,MAAAA,qBAAcrB;KAAnB,kBACAc,yBAAA,CAAAM,aAAA,CAAA,MAAA,EAAA;MAAKC,qBAAcrB,aAAnB,yBAAA,CAAA;MAAyDwB,OAAS,EAAA,iBAACC,CAAD,EAAA;QAAA,OAAOA,CAAA,CAAEC,eAAF,EAAP,CAAA;AAAA,OAAA;AAAlE,KAAA,iBACEZ,yBAAA,CAAAM,aAAA,CAAAT,UAAA,EAAA;MAAWa,OAAA,EAAS,iBAACC,CAAD,EAAA;AAAA,QAAA,OAAOtB,QAAP,KAAA,IAAA,IAAOA,QAAP,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAOA,QAAA,CAAW;AAAEsB,UAAAA,CAAG,EAAHA,CAAF;AAAKP,UAAAA,IAAA,EAAAA,IAAL;AAAWC,UAAAA,OAAAA,KAAAA;AAAX,SAAX,CAAP,CAAA;AAAA,OAAA;AAApB,KAAA,CADF,EAlBN,CAFF,CADuB,CAAA;GAA1B,CAAA;;AA8BM,EAAA,IAAAgB,eAAA,GAAA,EAAA,CAAA,MAAA,CAAqBnC,WAArB,EAAA,qBAAA,CAAA,CAAA,MAAA,CAAsDA,WAAtD,EAAA,gBAAA,CAAA,CAAA;AAEJ,EAAA,sBAAAc,yBAAA,CAAAM,aAAA,CAAC,KAAD,MAAA,iBACGN,yBAAA,CAAAM,aAAA,CAAA,IAAA,EAAA;AAAGC,IAAAA,qBAAcrB;AAAjB,GAAA,EACEF,YADF,KACEA,IAAAA,IAAAA,YADF,KACEA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,YAAc,CAAAkC,GAAd,CAAkB,UAACd,IAAD,EAAOC,KAAP,EAAiB;AAC9B,IAAA,IAAAD,IAAA,CAAKkB,MAAL,KAAgB,UAAhB,EAA4B;AAAA,MAAA,IAAA,gBAAA,CAAA;;AAC9B,MAAA,sBACGtB,yBAAA,CAAAM,aAAA,CAAA,IAAA,EAAA;AAAGC,QAAAA,SAAW,EAAAc,eAAd;AAA+BE,QAAAA,GAAA,EAAKnB,KAAKoB,IAAL,GAAYnB,KAAAA;AAAhD,OAAA,iBACEL,yBAAA,CAAAM,aAAA,CAAA,KAAA,EAAA;QAAIC,SAAA,EAAA,EAAA,CAAA,MAAA,CAAcrB,WAAd,EAAA,0BAAA,CAAA,CAAA,MAAA,CAAoDA,WAApD,EAAA,mBAAA,CAAA;AAAJ,OAAA,iBACEc,yBAAA,CAAAM,aAAA,CAAAmB,qBAAA,EAAA;AACCC,QAAAA,OAAS,EAAA,IADV;AAECC,QAAAA,IAAK,EAAA,QAFN;QAGCC,IAAA,iBACG5B,yBAAA,CAAAM,aAAA,CAAA,GAAA,EAAA,IAAA,EACErB,MADF,KACEA,IAAAA,IAAAA,MADF,KACEA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,CAAAA,gBAAAA,GAAAA,MAAQ,CAAA4C,QADV,MACE,IAAA,IAAA,gBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,gBAAA,CAAkBC,aADpB,EAEExC,kBAAqB,GAAA,EAAA,CAAA,MAAA,CAAGc,IAAK,CAAA2B,OAAR,EAAA,GAAA,CAAA,GAAqB,EAF5C,CAAA;OAJJ,CADF,CADF,CADH,CAAA;AAgBF,KAAA;;AACA,IAAA,sBACG/B,yBAAA,CAAAM,aAAA,CAAA,IAAA,EAAA;AAAGC,MAAAA,SAAW,EAAAc,eAAd;AAA+BE,MAAAA,GAAA,EAAKnB,KAAKoB,IAAL,GAAYnB,KAAAA;AAAhD,KAAA,EACEF,iBAAA,CAAkBC,IAAlB,EAAwBC,KAAxB,CADF,CADH,CAAA;GAnBD,CADF,EA0BEN,WAAA,mBACEC,yBAAA,CAAAM,aAAA,CAAA,IAAA,EAAA;AAAGC,IAAAA,SAAW,EAAAc,eAAd;IAA+BX,SAAS3B,KAAM,CAAAiD,aAAAA;AAA9C,GAAA,iBACEhC,yBAAA,CAAAM,aAAA,CAAA,KAAA,EAAA;IAAIC,SAAA,EAAA,EAAA,CAAA,MAAA,CAAcrB,WAAd,EAAA,0BAAA,CAAA,CAAA,MAAA,CAAoDA,WAApD,EAAA,mBAAA,CAAA;AAAJ,GAAA,iBACCc,yBAAA,CAAAM,aAAA,CAACb,OAAD,EAAS,IAAT,CADD,iBAEEO,yBAAA,CAAAM,aAAA,CAAA,GAAA,EAAA;AAAEC,IAAAA,qBAAcrB;GAAhB,EAAuCD,MAAvC,KAAA,IAAA,IAAuCA,MAAvC,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,CAAA,qBAAA,GAAuCA,MAAA,CAAQgD,iBAA/C,MAAA,IAAA,IAAA,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAuC,qBAA2BC,CAAAA,KAAlE,CAFF,CADF,CA3BJ,CADH,EAqCGnD,KAAM,CAAAoD,IAAN,mBAAenC,yBAAA,CAAAM,aAAA,CAAA,OAAA,EAAA;AAAMC,IAAAA,SAAA,EAAW6B,8BAAW,CAAArD,KAAA,CAAMsD,WAAN,CAAA;AAA5B,GAAA,EAAiDtD,KAAA,CAAMoD,IAAvD,CArClB,CAAA,CAAA;AAwCJ,EAvFA;;AAyFArD,SAAA,CAAUwD,WAAV,GAAwB,WAAxB;;;;"}