{"version":3,"file":"linear-gradient.js","sources":["../../../../src/color-picker/components/panel/linear-gradient.tsx"],"sourcesContent":["import React, { KeyboardEvent, MouseEvent as ReactMouseEvent, useCallback, useEffect, useRef, useState } from 'react';\nimport cloneDeep from 'lodash/cloneDeep';\nimport classNames from 'classnames';\nimport useClassName from '../../hooks/useClassNames';\nimport { genGradientPoint, gradientColors2string } from '../../../_common/js/color-picker/color';\nimport { GradientColorPoint } from '../../../_common/js/color-picker/gradient';\nimport useCommonClassName from '../../../_util/useCommonClassName';\nimport { GRADIENT_SLIDER_DEFAULT_WIDTH } from '../../const';\nimport InputNumber from '../../../input-number';\n\nconst DELETE_KEYS: string[] = ['delete', 'backspace'];\n\ntype TSliderRect = {\n  left: number;\n  width: number;\n};\n\nconst LinearGradient = (props) => {\n  const { onChange, color, disabled } = props;\n  const baseClassName = useClassName();\n  const { STATUS: statusClassNames } = useCommonClassName();\n  const refSlider = useRef<HTMLDivElement>(null);\n  const sliderRectRef = useRef<TSliderRect>({\n    left: 0,\n    width: GRADIENT_SLIDER_DEFAULT_WIDTH,\n  });\n  const isDragging = useRef<Boolean>(false);\n  const isMoved = useRef<Boolean>(false);\n  const degree = useRef(props.color.gradientDegree);\n  const [selectedId, setSelectedId] = useState(props.color.gradientSelectedId);\n  const selectedRef = useRef(props.color.gradientSelectedId);\n  const colors = useRef<GradientColorPoint[]>(cloneDeep(color.gradientColors));\n\n  useEffect(() => {\n    degree.current = color?.gradientDegree;\n    setSelectedId(color.gradientSelectedId);\n    selectedRef.current = color.gradientSelectedId;\n    colors.current = cloneDeep(color.gradientColors);\n  }, [color]);\n\n  const updateSliderRect = () => {\n    const rect = refSlider.current.getBoundingClientRect();\n    sliderRectRef.current = {\n      left: rect.left,\n      width: rect.width || GRADIENT_SLIDER_DEFAULT_WIDTH,\n    };\n  };\n\n  const handleChange = useCallback(\n    (key: 'degree' | 'selectedId' | 'colors', payload: any, addUsedColor?: boolean) => {\n      if (disabled) {\n        return;\n      }\n      onChange({\n        key,\n        payload,\n        addUsedColor,\n      });\n    },\n    [onChange, disabled],\n  );\n\n  const handleDegreeChange = (value: number) => {\n    if (props.disabled || value === props.color.gradientDegree) {\n      return;\n    }\n    degree.current = value;\n    handleChange('degree', value, true);\n  };\n\n  const handleSelectedIdChange = (value: string) => {\n    if (props.disabled) {\n      return;\n    }\n    setSelectedId(value);\n    selectedRef.current = value;\n    handleChange('selectedId', value);\n  };\n\n  const handleColorsChange = useCallback(\n    (value: GradientColorPoint[], isEnded?: boolean) => {\n      if (props.disabled) {\n        return;\n      }\n      colors.current = value;\n      handleChange('colors', value, isEnded);\n    },\n    [props.disabled, handleChange],\n  );\n\n  /**\n   * 设置bar的位置\n   * @param left\n   * @returns\n   */\n  const updateActiveThumbLeft = useCallback(\n    (left: number) => {\n      const index = colors.current.findIndex((c) => c.id === selectedRef.current);\n      if (index === -1) {\n        return;\n      }\n      const point = colors.current[index];\n      const formatLeft = Math.max(0, Math.min(sliderRectRef.current.width, left));\n\n      const percentLeft = (formatLeft / sliderRectRef.current.width) * 100;\n\n      const newColors = colors.current.map((item, i) =>\n        index !== i\n          ? item\n          : {\n              color: point.color,\n              left: percentLeft,\n              id: point.id,\n            },\n      );\n\n      handleColorsChange(newColors);\n    },\n    [handleColorsChange],\n  );\n\n  // 移动开始\n  const handleStart = (id: string, e: ReactMouseEvent) => {\n    if (isDragging.current || props.disabled) {\n      return;\n    }\n    selectedRef.current = id;\n    setSelectedId(id);\n    isMoved.current = false;\n    isDragging.current = true;\n    e.preventDefault();\n    e.stopPropagation();\n    // handleSelectedIdChange(id);\n    // 让 slider 获取焦点，以便键盘事件生效。\n    refSlider.current.focus();\n  };\n\n  // 移动中\n  const handleMove = useCallback(\n    (e: MouseEvent) => {\n      if (!isDragging.current || disabled) {\n        return;\n      }\n\n      const rect = refSlider.current.getBoundingClientRect();\n      const left = e.clientX - rect.x;\n      isMoved.current = true;\n      updateActiveThumbLeft(left);\n    },\n    [disabled, updateActiveThumbLeft],\n  );\n\n  // 移动结束\n  const handleEnd = useCallback(() => {\n    if (!isDragging.current) {\n      return;\n    }\n    setTimeout(() => {\n      isDragging.current = false;\n    }, 0);\n    if (isMoved.current) {\n      handleColorsChange(colors.current, true);\n      isMoved.current = false;\n    }\n  }, [handleColorsChange]);\n\n  const handleKeyup = (e: KeyboardEvent) => {\n    if (props.disabled) {\n      return;\n    }\n    const points = [...colors.current];\n    let pos = points.findIndex((c) => c.id === selectedRef.current);\n    const { length } = points;\n    // 必须保证有两个点\n    if (DELETE_KEYS.includes(e.key.toLocaleLowerCase()) && length > 2 && pos >= 0 && pos <= length - 1) {\n      points.splice(pos, 1);\n      if (!points[pos]) {\n        // eslint-disable-next-line no-nested-ternary\n        pos = points[pos + 1] ? pos + 1 : points[pos - 1] ? pos - 1 : 0;\n      }\n      const current = points[pos];\n      handleColorsChange(points, true);\n      handleSelectedIdChange(current?.id);\n    }\n  };\n\n  const handleThumbBarClick = (e: ReactMouseEvent) => {\n    if (props.disabled) {\n      return;\n    }\n    updateSliderRect();\n\n    let left = e.clientX - sliderRectRef.current.left;\n    left = Math.max(0, Math.min(sliderRectRef.current.width, left));\n    const percentLeft = (left / sliderRectRef.current.width) * 100;\n\n    const newPoint = genGradientPoint(percentLeft, props.color.rgba);\n    const newColors = [...colors.current];\n    newColors.push(newPoint);\n    handleColorsChange(newColors, true);\n    handleSelectedIdChange(newPoint.id);\n  };\n\n  useEffect(() => {\n    updateSliderRect();\n\n    window.addEventListener('mousemove', handleMove, false);\n    window.addEventListener('mouseup', handleEnd, false);\n    window.addEventListener('contextmenu', handleEnd, false);\n\n    return () => {\n      window.removeEventListener('mousemove', handleMove, false);\n      window.removeEventListener('mouseup', handleEnd, false);\n      window.removeEventListener('contextmenu', handleEnd, false);\n    };\n    // eslint-disable-next-line\n  }, []);\n\n  const { gradientColors } = props.color;\n\n  const thumbBackground = gradientColors2string({\n    points: gradientColors,\n    degree: 90,\n  });\n\n  const handleClickThumb = (e: ReactMouseEvent, t) => {\n    handleSelectedIdChange(t.id);\n    e.stopPropagation();\n  };\n\n  const allGradientColors = [...colors.current];\n  const { color: leftColor } = genGradientPoint(0, allGradientColors[0]?.color);\n  const { color: rightColor } = genGradientPoint(100, allGradientColors[allGradientColors.length - 1]?.color);\n\n  return (\n    <div className={`${baseClassName}__gradient`}>\n      <div\n        className={`${baseClassName}__gradient-slider`}\n        style={{\n          background: `linear-gradient(90deg, ${leftColor} 0%, ${leftColor} 50%, ${rightColor} 50%, ${rightColor} 100%)`,\n        }}\n      >\n        <div\n          className={classNames(`${baseClassName}__slider`, `${baseClassName}--bg-alpha`)}\n          onKeyUp={handleKeyup}\n          tabIndex={0}\n          ref={refSlider}\n        >\n          <ul\n            className=\"gradient-thumbs\"\n            onClick={handleThumbBarClick}\n            style={{\n              background: thumbBackground,\n            }}\n          >\n            {colors.current.map((t) => {\n              const left = `${Math.round(t.left * 100) / 100}%`;\n              return (\n                <li\n                  className={classNames([\n                    `${baseClassName}__thumb`,\n                    'gradient-thumbs__item',\n                    selectedId === t.id ? statusClassNames.active : '',\n                  ])}\n                  key={t.id}\n                  title={`${t.color} ${left}`}\n                  style={{\n                    color: t.color,\n                    left,\n                  }}\n                  onClick={(e) => handleClickThumb(e, t)}\n                  onMouseDown={(e: ReactMouseEvent) => handleStart(t.id, e)}\n                >\n                  <span className={classNames(['gradient-thumbs__item-inner', `${baseClassName}--bg-alpha`])}></span>\n                </li>\n              );\n            })}\n          </ul>\n        </div>\n      </div>\n      <div className={`${baseClassName}__gradient-degree`} title={`${degree}deg`}>\n        <InputNumber\n          theme=\"normal\"\n          min={0}\n          max={360}\n          step={1}\n          size=\"small\"\n          format={(value: number) => `${value}°`}\n          value={degree.current}\n          onBlur={handleDegreeChange}\n          onEnter={handleDegreeChange}\n          disabled={props.disabled}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(LinearGradient);\n"],"names":["DELETE_KEYS","LinearGradient","props","onChange","color","disabled","baseClassName","useClassName","useCommonClassName","statusClassNames","STATUS","refSlider","useRef","sliderRectRef","left","width","GRADIENT_SLIDER_DEFAULT_WIDTH","isDragging","isMoved","degree","gradientDegree","useState","gradientSelectedId","_slicedToArray","selectedId","setSelectedId","selectedRef","colors","cloneDeep","gradientColors","useEffect","current","updateSliderRect","rect","getBoundingClientRect","handleChange","useCallback","key","payload","addUsedColor","handleDegreeChange","value","handleSelectedIdChange","handleColorsChange","isEnded","updateActiveThumbLeft","index","findIndex","c","id","point","formatLeft","Math","max","min","percentLeft","newColors","map","item","i","handleStart","e","preventDefault","stopPropagation","focus","handleMove","clientX","x","handleEnd","setTimeout","handleKeyup","points","_toConsumableArray","pos","length","includes","toLocaleLowerCase","splice","handleThumbBarClick","newPoint","genGradientPoint","rgba","push","window","addEventListener","removeEventListener","thumbBackground","gradientColors2string","handleClickThumb","t","allGradientColors","leftColor","rightColor","React","createElement","className","style","background","classNames","onKeyUp","tabIndex","ref","onClick","round","active","title","onMouseDown","InputNumber","theme","step","size","format","onBlur","onEnter","memo"],"mappings":"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"}