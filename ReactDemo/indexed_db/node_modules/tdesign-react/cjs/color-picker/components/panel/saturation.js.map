{"version":3,"file":"saturation.js","sources":["../../../../src/color-picker/components/panel/saturation.tsx"],"sourcesContent":["import React, { useRef, useEffect, useCallback } from 'react';\nimport { SATURATION_PANEL_DEFAULT_HEIGHT, SATURATION_PANEL_DEFAULT_WIDTH } from '../../const';\nimport { TdColorBaseProps } from '../../interface';\nimport useDrag, { Coordinate } from '../../../_util/useDrag';\n\nconst Saturation = (props: TdColorBaseProps) => {\n  const { color, disabled, onChange, baseClassName } = props;\n  const panelRef = useRef<HTMLDivElement>(null);\n  const thumbRef = useRef<HTMLElement>(null);\n  const panelRectRef = useRef({\n    width: SATURATION_PANEL_DEFAULT_WIDTH,\n    height: SATURATION_PANEL_DEFAULT_HEIGHT,\n  });\n\n  const styles = () => {\n    const { saturation, value, rgb } = color;\n    const { width, height } = panelRectRef.current;\n    const top = Math.round((1 - value) * height);\n    const left = Math.round(saturation * width);\n    return {\n      color: rgb,\n      left: `${left}px`,\n      top: `${top}px`,\n    };\n  };\n\n  const getSaturationAndValueByCoordinate = (coordinate: Coordinate) => {\n    const { width, height } = panelRectRef.current;\n    const { x, y } = coordinate;\n    const saturation = Math.round((x / width) * 100);\n    const value = Math.round((1 - y / height) * 100);\n    return {\n      saturation,\n      value,\n    };\n  };\n\n  const isDragging = useRef<Boolean>(false);\n\n  const handleDrag = useCallback(\n    ({ x, y }: Coordinate, isEnd?: boolean) => {\n      if (disabled) {\n        return;\n      }\n      isDragging.current = true;\n      const { saturation, value } = getSaturationAndValueByCoordinate({ x, y });\n      onChange({\n        saturation: saturation / 100,\n        value: value / 100,\n        addUsedColor: isEnd,\n      });\n    },\n    [disabled, onChange],\n  );\n\n  const handleDragEnd = useCallback((coordinate: Coordinate) => {\n    if (disabled) {\n      return;\n    }\n    isDragging.current = false;\n    handleDrag(coordinate, true);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useDrag(panelRef, {\n    start: () => {\n      panelRectRef.current.width = panelRef.current.offsetWidth;\n      panelRectRef.current.height = panelRef.current.offsetHeight;\n    },\n    end: (coordinate: Coordinate) => {\n      handleDragEnd(coordinate);\n    },\n    drag: (coordinate: Coordinate) => {\n      handleDrag(coordinate);\n    },\n  });\n\n  useEffect(() => {\n    panelRectRef.current.width = panelRef.current.offsetWidth || SATURATION_PANEL_DEFAULT_WIDTH;\n    panelRectRef.current.height = panelRef.current.offsetHeight || SATURATION_PANEL_DEFAULT_HEIGHT;\n  }, [handleDrag, handleDragEnd]);\n\n  return (\n    <div\n      className={`${baseClassName}__saturation`}\n      ref={panelRef}\n      style={{\n        background: `hsl(${color.hue}, 100%, 50%)`,\n      }}\n    >\n      <span\n        className={`${baseClassName}__thumb`}\n        role=\"slider\"\n        tabIndex={0}\n        ref={thumbRef}\n        style={{ ...styles() }}\n      ></span>\n    </div>\n  );\n};\n\nexport default React.memo(Saturation);\n"],"names":["Saturation","props","color","disabled","onChange","baseClassName","panelRef","useRef","thumbRef","panelRectRef","width","SATURATION_PANEL_DEFAULT_WIDTH","height","SATURATION_PANEL_DEFAULT_HEIGHT","styles","saturation","value","rgb","current","top","Math","round","left","getSaturationAndValueByCoordinate","coordinate","x","y","isDragging","handleDrag","useCallback","isEnd","addUsedColor","handleDragEnd","useDrag","start","offsetWidth","offsetHeight","end","drag","useEffect","React","createElement","className","ref","style","background","hue","role","tabIndex","memo"],"mappings":"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"}