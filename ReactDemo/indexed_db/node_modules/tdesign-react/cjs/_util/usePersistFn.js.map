{"version":3,"file":"usePersistFn.js","sources":["../../src/_util/usePersistFn.ts"],"sourcesContent":["import { useRef } from 'react';\n\nexport type Noop = (...args: any[]) => any;\n\n/**\n *  在某些场景中，你可能会需要用 useCallback 记住一个回调，\n *  但由于内部函数必须经常重新创建，记忆效果不是很好，导致子组件重复 render。\n *  对于超级复杂的子组件，重新渲染会对性能造成影响。\n *  通过 usePersistFn，可以保证函数地址永远不会变化。\n * @param fn\n */\nexport function usePersistFn<T extends Noop>(fn: T) {\n  const fnRef = useRef<T>(fn);\n  fnRef.current = fn;\n\n  const persistFn = useRef<T>();\n  if (!persistFn.current) {\n    persistFn.current = function (...args) {\n      return fnRef.current.apply(this, args);\n    } as T;\n  }\n\n  return persistFn.current;\n}\n"],"names":["usePersistFn","fn","fnRef","useRef","current","persistFn","args","apply"],"mappings":";;;;;;;;;;;;AAWO,SAASA,YAAT,CAAsCC,EAAtC,EAA6C;AAC5C,EAAA,IAAAC,KAAA,GAAQC,aAAUF,GAAlB,CAAA;EACNC,KAAA,CAAME,OAAN,GAAgBH,EAAhB,CAAA;EAEA,IAAMI,YAAYF,YAAU,EAA5B,CAAA;;AACI,EAAA,IAAA,CAACE,UAAUD,OAAX,EAAoB;IACZC,SAAA,CAAAD,OAAA,GAAU,YAAmB;AAAA,MAAA,KAAA,IAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAANE,IAAM,GAAA,IAAA,KAAA,CAAA,IAAA,CAAA,EAAA,IAAA,GAAA,CAAA,EAAA,IAAA,GAAA,IAAA,EAAA,IAAA,EAAA,EAAA;QAANA,IAAM,CAAA,IAAA,CAAA,GAAA,SAAA,CAAA,IAAA,CAAA,CAAA;AAAA,OAAA;;MACrC,OAAOJ,KAAM,CAAAE,OAAN,CAAcG,KAAd,CAAoB,IAApB,EAA0BD,IAA1B,CAAP,CAAA;KADQ,CAAA;AAGZ,GAAA;;EAEA,OAAOD,SAAU,CAAAD,OAAjB,CAAA;AACF;;;;"}