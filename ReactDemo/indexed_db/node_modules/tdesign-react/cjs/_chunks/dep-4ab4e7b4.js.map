{"version":3,"file":"dep-4ab4e7b4.js","sources":["../../src/radio/RadioGroup.tsx","../../src/radio/Radio.tsx"],"sourcesContent":["import React, { ReactNode, useState, useEffect, useRef } from 'react';\nimport classNames from 'classnames';\nimport useConfig from '../hooks/useConfig';\nimport { TdRadioGroupProps } from './type';\nimport useControlled from '../hooks/useControlled';\nimport useCommonClassName from '../_util/useCommonClassName';\nimport { StyledProps } from '../common';\nimport { CheckContext, CheckContextValue } from '../common/Check';\nimport Radio from './Radio';\nimport useMutationObservable from '../_util/useMutationObserver';\nimport { radioGroupDefaultProps } from './defaultProps';\n\n/**\n * RadioGroup 组件所接收的属性\n */\nexport interface RadioGroupProps extends TdRadioGroupProps, StyledProps {\n  children?: ReactNode;\n}\n\n/**\n * 单选选项组，里面可以嵌套 <Radio />\n */\nconst RadioGroup = (props: RadioGroupProps) => {\n  const { classPrefix } = useConfig();\n  const { disabled, children, onChange, size, variant, options = [], className, style } = props;\n\n  const [internalValue, setInternalValue] = useControlled(props, 'value', onChange);\n  const [barStyle, setBarStyle] = useState({});\n  const groupRef = useRef(null);\n\n  const checkedRadioCls = `.${classPrefix}-radio-button.${classPrefix}-is-checked`;\n  const { SIZE: sizeMap } = useCommonClassName();\n\n  const context: CheckContextValue = {\n    inject: (checkProps) => {\n      // 如果已经受控，则不注入\n      if (typeof checkProps.checked !== 'undefined') {\n        return checkProps;\n      }\n\n      const { value: checkValue } = checkProps;\n\n      return {\n        ...checkProps,\n        checked: internalValue === checkProps.value,\n        disabled: checkProps.disabled || disabled,\n        onChange(checked, { e }) {\n          if (typeof checkProps.onChange === 'function') {\n            checkProps.onChange(checked, { e });\n          }\n          setInternalValue(checked ? checkValue : undefined, { e });\n        },\n      };\n    },\n  };\n\n  const calcBarStyle = () => {\n    if (!variant.includes('filled')) return;\n    const checkedRadio = groupRef.current.querySelector?.(checkedRadioCls);\n    if (!checkedRadio) return setBarStyle({ width: 0 });\n\n    const { offsetWidth, offsetLeft } = checkedRadio;\n    setBarStyle({ width: `${offsetWidth}px`, left: `${offsetLeft}px` });\n  };\n\n  useEffect(() => {\n    calcBarStyle();\n  }, [groupRef.current, internalValue]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useMutationObservable(groupRef.current, calcBarStyle);\n\n  const renderBlock = () => {\n    if (!variant.includes('filled')) return null;\n    return <div style={barStyle} className={`${classPrefix}-radio-group__bg-block`}></div>;\n  };\n\n  const renderOptions = () =>\n    options.map((item) => {\n      if (typeof item === 'string' || typeof item === 'number') {\n        return (\n          <Radio value={item} key={item}>\n            {item}\n          </Radio>\n        );\n      }\n      return (\n        <Radio value={item.value} key={item.value} disabled={item.disabled}>\n          {item.label}\n        </Radio>\n      );\n    });\n\n  return (\n    <CheckContext.Provider value={context}>\n      <div\n        ref={groupRef}\n        style={style}\n        className={classNames(`${classPrefix}-radio-group`, sizeMap[size], className, {\n          [`${classPrefix}-radio-group__outline`]: variant === 'outline',\n          [`${classPrefix}-radio-group--filled`]: variant.includes('filled'),\n          [`${classPrefix}-radio-group--primary-filled`]: variant === 'primary-filled',\n        })}\n      >\n        {children || renderOptions()}\n        {renderBlock()}\n      </div>\n    </CheckContext.Provider>\n  );\n};\n\nRadioGroup.displayName = 'RadioGroup';\nRadioGroup.defaultProps = radioGroupDefaultProps;\n\nexport default RadioGroup;\n","import React, { Ref, forwardRef } from 'react';\nimport forwardRefWithStatics from '../_util/forwardRefWithStatics';\nimport Check, { CheckProps } from '../common/Check';\nimport RadioGroup from './RadioGroup';\nimport { radioDefaultProps } from './defaultProps';\n\nexport type RadioProps = Omit<CheckProps, 'type'>;\n\nconst Radio = forwardRefWithStatics(\n  (props: RadioProps, ref: Ref<HTMLLabelElement>) => <Check ref={ref} type=\"radio\" {...props} />,\n  {\n    Group: RadioGroup,\n    Button: forwardRef((props: RadioProps, ref: Ref<HTMLLabelElement>) => (\n      <Check ref={ref} type=\"radio-button\" {...props} />\n    )),\n  },\n);\n\nRadio.displayName = 'Radio';\nRadio.defaultProps = radioDefaultProps;\n\nexport default Radio;\n"],"names":["RadioGroup","props","useConfig","classPrefix","disabled","children","onChange","size","variant","options","className","style","useControlled","_slicedToArray","internalValue","setInternalValue","useState","barStyle","setBarStyle","groupRef","useRef","checkedRadioCls","useCommonClassName","sizeMap","SIZE","context","inject","checkProps","checked","checkValue","value","_objectSpread","e","calcBarStyle","includes","checkedRadio","current","querySelector","width","offsetWidth","offsetLeft","left","useEffect","useMutationObservable","renderBlock","React","createElement","renderOptions","map","item","Radio","key","label","CheckContext","Provider","ref","classNames","_defineProperty","displayName","defaultProps","radioGroupDefaultProps","forwardRefWithStatics","Check","type","Group","Button","forwardRef","radioDefaultProps"],"mappings":"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"}