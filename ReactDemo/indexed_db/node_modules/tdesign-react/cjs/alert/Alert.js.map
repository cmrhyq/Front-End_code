{"version":3,"file":"Alert.js","sources":["../../src/alert/Alert.tsx"],"sourcesContent":["import React, { forwardRef, useRef } from 'react';\nimport classNames from 'classnames';\nimport {\n  CloseIcon as TdCloseIcon,\n  InfoCircleFilledIcon as TdInfoCircleFilledIcon,\n  CheckCircleFilledIcon as TdCheckCircleFilledIcon,\n  ErrorCircleFilledIcon as TdErrorCircleFilledIcon,\n} from 'tdesign-icons-react';\nimport { CSSTransition } from 'react-transition-group';\nimport noop from '../_util/noop';\nimport renderTNode from '../_util/renderTNode';\nimport useConfig from '../hooks/useConfig';\nimport useGlobalIcon from '../hooks/useGlobalIcon';\nimport { useLocaleReceiver } from '../locale/LocalReceiver';\nimport { TdAlertProps } from './type';\nimport { StyledProps } from '../common';\nimport { alertDefaultProps } from './defaultProps';\nimport composeRefs from '../_util/composeRefs';\n\nconst transitionTime = 200;\n\nexport interface AlertProps extends TdAlertProps, StyledProps {}\n\nconst Alert = forwardRef((props: AlertProps, ref: React.Ref<HTMLDivElement>) => {\n  const { classPrefix } = useConfig();\n  const [local, t] = useLocaleReceiver('alert');\n  const { CloseIcon, InfoCircleFilledIcon, CheckCircleFilledIcon, ErrorCircleFilledIcon } = useGlobalIcon({\n    CloseIcon: TdCloseIcon,\n    InfoCircleFilledIcon: TdInfoCircleFilledIcon,\n    CheckCircleFilledIcon: TdCheckCircleFilledIcon,\n    ErrorCircleFilledIcon: TdErrorCircleFilledIcon,\n  });\n\n  const {\n    message,\n    title,\n    operation,\n    theme,\n    icon,\n    close,\n    maxLine,\n    onClose,\n    className,\n    onClosed = noop,\n    ...alertProps\n  } = props;\n\n  const [closed, setClosed] = React.useState(false);\n  const [collapsed, setCollapsed] = React.useState(false);\n\n  const iconMap = {\n    success: CheckCircleFilledIcon,\n    info: InfoCircleFilledIcon,\n    error: ErrorCircleFilledIcon,\n    warning: ErrorCircleFilledIcon,\n  };\n\n  const handleClose = (e: React.MouseEvent<HTMLDivElement>) => {\n    setClosed(true);\n    onClose?.({ e });\n  };\n\n  const handleCollapse = () => {\n    setCollapsed(!collapsed);\n  };\n\n  const renderIconNode = () => {\n    if (React.isValidElement(icon)) {\n      return React.cloneElement(icon as React.ReactElement, {\n        className: classNames({\n          [icon.props.className]: icon.props.className,\n        }),\n      });\n    }\n    return React.createElement(iconMap[theme] || iconMap.info);\n  };\n\n  const renderMessage = () => {\n    if (+maxLine > 0 && Array.isArray(message)) {\n      return (\n        <div className={`${classPrefix}-alert__description`}>\n          {message.map((item, index) => {\n            if (!collapsed) {\n              if (index < maxLine) {\n                return <div key={index}>{item}</div>;\n              }\n            } else {\n              return <div key={index}>{item}</div>;\n            }\n            return true;\n          })}\n          {+maxLine > 0 ? (\n            <div className={`${classPrefix}-alert__collapse`} onClick={handleCollapse}>\n              {!collapsed ? t(local.expandText) : t(local.collapseText)}\n            </div>\n          ) : null}\n        </div>\n      );\n    }\n    return <div className={`${classPrefix}-alert__description`}>{message}</div>;\n  };\n\n  const renderClose = () => (\n    <div className={`${classPrefix}-alert__close`} onClick={handleClose}>\n      {typeof close === 'boolean' ? <CloseIcon /> : renderTNode(close)}\n    </div>\n  );\n\n  const nodeRef = useRef<HTMLDivElement>();\n\n  return (\n    <CSSTransition\n      in={!closed}\n      unmountOnExit\n      classNames={{\n        exitActive: `${classPrefix}-alert--closing`,\n      }}\n      nodeRef={nodeRef}\n      timeout={transitionTime}\n      onExited={onClosed}\n    >\n      <div\n        ref={composeRefs(ref, nodeRef)}\n        className={classNames(`${classPrefix}-alert`, `${classPrefix}-alert--${theme}`, className)}\n        {...alertProps}\n      >\n        <div className={`${classPrefix}-alert__icon`}>{renderIconNode()}</div>\n        <div className={`${classPrefix}-alert__content`}>\n          {title ? <div className={`${classPrefix}-alert__title`}>{title}</div> : null}\n          <div className={`${classPrefix}-alert__message`}>\n            {renderMessage()}\n            {operation ? <div className={`${classPrefix}-alert__operation`}>{operation}</div> : null}\n          </div>\n        </div>\n        {close ? renderClose() : null}\n      </div>\n    </CSSTransition>\n  );\n});\n\nAlert.displayName = 'Alert';\nAlert.defaultProps = alertDefaultProps;\n\nexport default Alert;\n"],"names":["transitionTime","Alert","forwardRef","props","ref","useConfig","classPrefix","useLocaleReceiver","_slicedToArray","local","t","useGlobalIcon","CloseIcon","TdCloseIcon","InfoCircleFilledIcon","TdInfoCircleFilledIcon","CheckCircleFilledIcon","TdCheckCircleFilledIcon","ErrorCircleFilledIcon","TdErrorCircleFilledIcon","message","title","operation","theme","icon","close","maxLine","onClose","className","onClosed","noop","alertProps","React","useState","closed","setClosed","collapsed","setCollapsed","iconMap","success","info","error","warning","handleClose","e","handleCollapse","renderIconNode","isValidElement","cloneElement","classNames","createElement","renderMessage","Array","isArray","map","item","index","key","onClick","expandText","collapseText","renderClose","renderTNode","nodeRef","useRef","CSSTransition","unmountOnExit","exitActive","timeout","onExited","composeRefs","displayName","defaultProps","alertDefaultProps"],"mappings":"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"}