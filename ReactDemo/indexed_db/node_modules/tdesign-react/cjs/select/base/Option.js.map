{"version":3,"file":"Option.js","sources":["../../../src/select/base/Option.tsx"],"sourcesContent":["import React, { useRef } from 'react';\nimport classNames from 'classnames';\nimport isNumber from 'lodash/isNumber';\nimport isString from 'lodash/isString';\nimport get from 'lodash/get';\n\nimport useConfig from '../../hooks/useConfig';\nimport useRipple from '../../_util/useRipple';\nimport { StyledProps } from '../../common';\nimport { SelectValue, TdOptionProps, TdSelectProps, SelectKeysType } from '../type';\n\n/**\n * Option 组件属性\n */\nexport interface SelectOptionProps\n  extends StyledProps,\n    TdOptionProps,\n    Pick<TdSelectProps, 'size' | 'multiple' | 'max'> {\n  selectedValue?: SelectValue;\n  children?: React.ReactNode;\n  onSelect?: (\n    value: string | number,\n    context: {\n      label?: string;\n      selected?: boolean;\n      event: React.MouseEvent<HTMLLIElement>;\n      restData?: Record<string, any>;\n    },\n  ) => void;\n  restData?: Record<string, any>;\n  keys?: SelectKeysType;\n}\n\nconst componentType = 'select';\n\nconst Option = (props: SelectOptionProps) => {\n  const {\n    disabled: propDisabled,\n    label: propLabel,\n    selectedValue,\n    multiple,\n    size,\n    max,\n    keys,\n    value,\n    onSelect,\n    children,\n    content,\n    restData,\n    style,\n    className,\n  } = props;\n\n  let selected: boolean;\n  const label = propLabel || value;\n  const disabled = propDisabled || (multiple && Array.isArray(selectedValue) && max && selectedValue.length >= max);\n\n  const { classPrefix } = useConfig();\n  const optionRef = useRef();\n  // 使用斜八角动画\n  useRipple(optionRef);\n\n  // 处理单选场景\n  if (!multiple) {\n    selected =\n      isNumber(selectedValue) || isString(selectedValue)\n        ? value === selectedValue\n        : value === get(selectedValue, keys?.value || 'value');\n  }\n\n  // 处理多选场景\n  if (multiple && Array.isArray(selectedValue)) {\n    selected = selectedValue.some((item) => {\n      if (isNumber(item) || isString(item)) {\n        // 如果非 object 类型\n        return item === value;\n      }\n      return get(item, keys?.value || 'value') === value;\n    });\n  }\n\n  const handleSelect = (event: React.MouseEvent<HTMLLIElement>) => {\n    if (!disabled) {\n      onSelect(value, { label: String(label), selected, event, restData });\n    }\n  };\n\n  const renderItem = (children: React.ReactNode) => {\n    if (multiple) {\n      return (\n        <label\n          className={classNames(`${classPrefix}-checkbox`, {\n            [`${classPrefix}-is-disabled`]: disabled,\n            [`${classPrefix}-is-checked`]: selected,\n          })}\n        >\n          <input\n            type=\"checkbox\"\n            className={classNames(`${classPrefix}-checkbox__former`)}\n            value=\"\"\n            disabled={disabled && !selected}\n            onClick={(e) => e.stopPropagation()}\n          />\n          <span className={classNames(`${classPrefix}-checkbox__input`)}></span>\n          <span className={classNames(`${classPrefix}-checkbox__label`)}>{children || content || label}</span>\n        </label>\n      );\n    }\n    return <span>{children || content || label}</span>;\n  };\n\n  return (\n    <li\n      className={classNames(className, `${classPrefix}-${componentType}-option`, {\n        [`${classPrefix}-is-disabled`]: disabled,\n        [`${classPrefix}-is-selected`]: selected,\n        [`${classPrefix}-size-s`]: size === 'small',\n        [`${classPrefix}-size-l`]: size === 'large',\n      })}\n      key={value}\n      onClick={handleSelect}\n      ref={optionRef}\n      style={style}\n    >\n      {renderItem(children)}\n    </li>\n  );\n};\n\nexport default Option;\n"],"names":["componentType","Option","props","propDisabled","disabled","propLabel","label","selectedValue","multiple","size","max","keys","value","onSelect","children","content","restData","style","className","selected","Array","isArray","length","useConfig","classPrefix","optionRef","useRef","useRipple","isNumber","isString","get","some","item","handleSelect","event","String","renderItem","React","createElement","classNames","_defineProperty","type","onClick","e","stopPropagation","key","ref"],"mappings":"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"}