{"version":3,"file":"useMenuContext.js","sources":["../../../node_modules/lodash/noop.js","../../../src/menu/hooks/useMenuContext.ts"],"sourcesContent":["/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nmodule.exports = noop;\n","import noop from 'lodash/noop';\nimport { useState, ReactNode } from 'react';\nimport { MenuState, SetMenuState, MenuMode } from '../MenuContext';\nimport checkSubMenuChildExpanded from '../_util/checkSubMenuChildExpanded';\nimport { TdMenuProps, TdHeadMenuProps, MenuValue } from '../type';\n\ninterface UseMenuContextProps extends Extract<TdMenuProps, TdHeadMenuProps> {\n  children: ReactNode;\n  mode: MenuMode;\n}\n\nfunction useMenuContext({\n  defaultValue,\n  defaultExpanded,\n  expandMutex,\n  children,\n  onExpand = noop,\n  onChange = noop,\n  value,\n  expanded,\n  collapsed,\n  expandType,\n  theme,\n  mode,\n}: UseMenuContextProps) {\n  const [state, setState] = useState<MenuState>({\n    active: defaultValue,\n    expanded: defaultExpanded,\n  });\n\n  const setStateValue: SetMenuState = (menuState) => setState({ ...state, ...menuState });\n\n  const handleExpandChange = (value: MenuValue, expanded: MenuValue[]) => {\n    let nextExpand = [];\n    const index = expanded.indexOf(value);\n\n    // 已经展开\n    if (index > -1) {\n      // 互斥情况\n      if (expandMutex) {\n        nextExpand = expanded.slice(0, index);\n      } else {\n        nextExpand = expanded.filter((item) => item !== value);\n      }\n    } else if (expandMutex) {\n      // 未展开\n      nextExpand = checkSubMenuChildExpanded(children, expanded, value);\n    } else {\n      nextExpand = [...expanded, value];\n    }\n    onExpand(nextExpand);\n    setState({ expanded: nextExpand });\n  };\n\n  return {\n    value: {\n      onExpand: handleExpandChange,\n      onChange,\n      active: value || state.active,\n      expanded: expanded || state.expanded,\n      collapsed: collapsed || state.collapsed,\n      setState: setStateValue,\n      expandMutex,\n      expandType: collapsed ? 'popup' : expandType,\n      mode,\n      theme,\n    },\n  };\n}\n\nexport default useMenuContext;\n"],"names":["noop","noop_1","useMenuContext","defaultValue","defaultExpanded","expandMutex","children","onExpand","onChange","value","expanded","collapsed","expandType","theme","mode","useState","active","state","setState","setStateValue","menuState","handleExpandChange","nextExpand","index","indexOf","slice","filter","item","checkSubMenuChildExpanded"],"mappings":"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"}