{"version":3,"file":"useClickOutside.js","sources":["../../src/_util/useClickOutside.ts"],"sourcesContent":["import { MutableRefObject, useEffect } from 'react';\nimport useConfig from '../hooks/useConfig';\n\nexport default function useClickOutside<T extends HTMLElement>(\n  refs: MutableRefObject<T>[],\n  handler: (event: MouseEvent | TouchEvent) => void,\n  includePopup?: boolean,\n) {\n  const { classPrefix } = useConfig();\n  const POPUP_SELECTOR = `.${classPrefix}-popup`;\n\n  useEffect(() => {\n    const listener = (event) => {\n      if (!Array.isArray(refs)) {\n        return;\n      }\n\n      let elements = [];\n      if (includePopup) {\n        document.querySelectorAll(POPUP_SELECTOR).forEach((ele: Element) => {\n          elements.push(ele as HTMLElement);\n        });\n      }\n      elements = Array.from(new Set(elements));\n\n      // Do nothing if clicking ref's element or descendent elements\n      if (\n        refs.find((ref) => ref.current?.contains(event.target)) ||\n        elements.find((el) => el?.contains(event.target))\n      ) {\n        return;\n      }\n      handler(event);\n    };\n    // todo: pointerdown， jsdom 暂未实现 pointer 事件，后续加上后可以改进.\n    document.addEventListener('mousedown', listener);\n    document.addEventListener('touchstart', listener);\n    return () => {\n      document.removeEventListener('mousedown', listener);\n      document.removeEventListener('touchstart', listener);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [refs, handler, includePopup]);\n}\n"],"names":["useClickOutside","refs","handler","includePopup","useConfig","classPrefix","POPUP_SELECTOR","useEffect","listener","event","Array","isArray","elements","document","querySelectorAll","forEach","ele","push","from","Set","find","ref","current","contains","target","el","addEventListener","removeEventListener"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGwB,SAAAA,eAAA,CACtBC,IADsB,EAEtBC,OAFsB,EAGtBC,YAHsB,EAItB;AACM,EAAA,IAAA,UAAA,GAAkBC,SAAU,EAA5B;MAAEC,WAAF,cAAEA,WAAF,CAAA;;EACN,IAAMC,iBAAqBD,GAAAA,CAAAA,MAAAA,CAAAA,aAA3B,QAAA,CAAA,CAAA;AAEAE,EAAAA,SAAA,CAAU,YAAM;AACR,IAAA,IAAAC,QAAA,GAAW,SAAXA,QAAW,CAACC,KAAD,EAAW;AAC1B,MAAA,IAAI,CAACC,KAAA,CAAMC,OAAN,CAAcV,IAAd,CAAL,EAA0B;AACxB,QAAA,OAAA;AACF,OAAA;;MAEA,IAAIW,WAAW,EAAf,CAAA;;AACA,MAAA,IAAIT,YAAJ,EAAkB;QAChBU,QAAA,CAASC,gBAAT,CAA0BR,cAA1B,EAA0CS,OAA1C,CAAkD,UAACC,GAAD,EAAkB;UAClEJ,QAAA,CAASK,IAAT,CAAcD,GAAd,CAAA,CAAA;SADF,CAAA,CAAA;AAGF,OAAA;;MACAJ,QAAA,GAAWF,KAAM,CAAAQ,IAAN,CAAW,IAAIC,GAAJ,CAAQP,QAAR,CAAX,CAAX,CAAA;;AAIE,MAAA,IAAAX,IAAA,CAAKmB,IAAL,CAAU,UAACC,GAAD,EAAA;AAAA,QAAA,IAAA,YAAA,CAAA;;QAAA,OAASA,CAAAA,YAAAA,GAAAA,IAAIC,OAAb,MAAS,IAAA,IAAA,YAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,YAAA,CAAaC,QAAb,CAAsBd,MAAMe,MAA5B,CAAT,CAAA;AAAA,OAAV,KACAZ,QAAS,CAAAQ,IAAT,CAAc,UAACK,EAAD,EAAA;QAAA,OAAQA,EAAR,KAAQA,IAAAA,IAAAA,EAAR,KAAQA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,EAAA,CAAIF,QAAJ,CAAad,KAAM,CAAAe,MAAnB,CAAR,CAAA;AAAA,OAAd,CADA,EAEA;AACA,QAAA,OAAA;AACF,OAAA;;MACAtB,OAAA,CAAQO,KAAR,CAAA,CAAA;KApBI,CAAA;;AAuBGI,IAAAA,QAAA,CAAAa,gBAAA,CAAiB,WAAjB,EAA8BlB,QAA9B,CAAA,CAAA;AACAK,IAAAA,QAAA,CAAAa,gBAAA,CAAiB,YAAjB,EAA+BlB,QAA/B,CAAA,CAAA;AACT,IAAA,OAAO,YAAM;AACFK,MAAAA,QAAA,CAAAc,mBAAA,CAAoB,WAApB,EAAiCnB,QAAjC,CAAA,CAAA;AACAK,MAAAA,QAAA,CAAAc,mBAAA,CAAoB,YAApB,EAAkCnB,QAAlC,CAAA,CAAA;KAFX,CAAA;GA1BF,EA+BG,CAACP,IAAD,EAAOC,OAAP,EAAgBC,YAAhB,CA/BH,CAAA,CAAA;AAgCF;;;;"}