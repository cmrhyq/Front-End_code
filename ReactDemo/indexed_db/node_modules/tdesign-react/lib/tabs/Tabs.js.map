{"version":3,"file":"Tabs.js","sources":["../../src/tabs/Tabs.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport classNames from 'classnames';\nimport { TabValue, TdTabsProps } from './type';\nimport forwardRefWithStatics from '../_util/forwardRefWithStatics';\nimport TabNav from './TabNav';\nimport { useTabClass } from './useTabClass';\nimport TabPanel from './TabPanel';\nimport { StyledProps } from '../common';\nimport { tabsDefaultProps } from './defaultProps';\n\nexport interface TabsProps extends TdTabsProps, StyledProps {\n  children?: React.ReactNode;\n}\n\nconst Tabs = forwardRefWithStatics(\n  (props: TabsProps, ref) => {\n    const { children, placement, onRemove, value: tabValue, onChange, className, style } = props;\n    let { defaultValue } = props;\n\n    // 样式工具引入\n    const { tdTabsClassPrefix, tdTabsClassGenerator, tdClassGenerator } = useTabClass();\n\n    const itemList = React.Children.map(children, (child: any) => {\n      if (child && child.type === TabPanel) {\n        return child.props;\n      }\n      return null;\n    });\n\n    // 当未设置默认值时，默认选中第一个。\n    if (defaultValue === undefined && Array.isArray(itemList) && itemList.length !== 0) {\n      defaultValue = itemList[0].value;\n    }\n\n    const [value, setValue] = useState<TabValue>(defaultValue);\n\n    useEffect(() => {\n      tabValue !== undefined && setValue(tabValue);\n    }, [tabValue]);\n\n    const handleChange = (v) => {\n      if (tabValue === undefined) {\n        setValue(v);\n      }\n      onChange?.(v);\n    };\n\n    const handleClickTab = (v) => {\n      if (tabValue === undefined) {\n        setValue(v);\n      }\n    };\n\n    const renderHeader = () => (\n      <div className={classNames(tdTabsClassGenerator('header'), tdClassGenerator(`is-${placement}`))}>\n        <TabNav\n          {...props}\n          activeValue={value}\n          onRemove={onRemove}\n          itemList={itemList}\n          tabClick={handleClickTab}\n          onChange={handleChange}\n        />\n      </div>\n    );\n\n    return (\n      <div ref={ref} className={classNames(tdTabsClassPrefix, className)} style={style}>\n        {placement !== 'bottom' ? renderHeader() : null}\n        <div className={classNames(tdTabsClassGenerator('content'), tdClassGenerator(`is-${placement}`))}>\n          {React.Children.map(children, (child: any) => {\n            if (child && child.type === TabPanel) {\n              if (child.props.value === value) {\n                return child;\n              }\n              if (child.props.destroyOnHide === false) {\n                return <TabPanel style={{ display: 'none' }}>{child.props.children}</TabPanel>;\n              }\n            }\n            return null;\n          })}\n        </div>\n        {placement === 'bottom' ? renderHeader() : null}\n      </div>\n    );\n  },\n  { TabPanel },\n);\n\nTabs.displayName = 'Tabs';\nTabs.defaultProps = tabsDefaultProps;\n\nexport default Tabs;\n"],"names":["Tabs","forwardRefWithStatics","props","ref","children","placement","onRemove","tabValue","value","onChange","className","style","defaultValue","useTabClass","tdTabsClassPrefix","tdTabsClassGenerator","tdClassGenerator","itemList","React","Children","map","child","type","TabPanel","Array","isArray","length","useState","setValue","useEffect","handleChange","v","handleClickTab","renderHeader","createElement","classNames","TabNav","activeValue","tabClick","destroyOnHide","display","displayName","defaultProps","tabsDefaultProps"],"mappings":"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"}