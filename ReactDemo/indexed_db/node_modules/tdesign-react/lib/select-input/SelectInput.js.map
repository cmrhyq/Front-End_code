{"version":3,"file":"SelectInput.js","sources":["../../src/select-input/SelectInput.tsx"],"sourcesContent":["import React, { forwardRef, useRef, useImperativeHandle } from 'react';\nimport classNames from 'classnames';\nimport useConfig from '../hooks/useConfig';\nimport Popup from '../popup';\nimport useSingle from './useSingle';\nimport useMultiple from './useMultiple';\nimport useOverlayInnerStyle from './useOverlayInnerStyle';\nimport { TdSelectInputProps } from './type';\nimport { StyledProps } from '../common';\nimport { selectInputDefaultProps } from './defaultProps';\n\nexport interface SelectInputProps extends TdSelectInputProps, StyledProps {\n  updateScrollTop?: (content: HTMLDivElement) => void;\n}\n\nconst SelectInput = forwardRef((props: SelectInputProps, ref) => {\n  const selectInputRef = useRef();\n  const selectInputWrapRef = useRef();\n  const { classPrefix: prefix } = useConfig();\n  const { multiple, value, popupVisible, popupProps, borderless, disabled } = props;\n  const { tOverlayInnerStyle, innerPopupVisible, onInnerPopupVisibleChange } = useOverlayInnerStyle(props);\n  const { commonInputProps, inputRef, onInnerClear, renderSelectSingle } = useSingle(props);\n  const { tagInputRef, renderSelectMultiple } = useMultiple(props);\n\n  const popupClasses = classNames([\n    props.className,\n    `${prefix}-select-input`,\n    {\n      [`${prefix}-select-input--borderless`]: borderless,\n      [`${prefix}-select-input--multiple`]: multiple,\n      [`${prefix}-select-input--popup-visible`]: popupVisible ?? innerPopupVisible,\n      [`${prefix}-select-input--empty`]: value instanceof Array ? !value.length : !value,\n    },\n  ]);\n\n  useImperativeHandle(ref, () => ({\n    ...(selectInputRef.current || {}),\n    ...(inputRef.current || {}),\n    ...(tagInputRef.current || {}),\n  }));\n\n  // 浮层显示的受控与非受控\n  const visibleProps = { visible: popupVisible ?? innerPopupVisible };\n\n  const mainContent = (\n    <div className={popupClasses} style={props.style}>\n      <Popup\n        ref={selectInputRef}\n        trigger={popupProps?.trigger || 'click'}\n        placement=\"bottom-left\"\n        content={props.panel}\n        hideEmptyPopup={true}\n        onVisibleChange={onInnerPopupVisibleChange}\n        {...visibleProps}\n        {...popupProps}\n        disabled={disabled}\n        overlayInnerStyle={tOverlayInnerStyle}\n        updateScrollTop={props.updateScrollTop}\n      >\n        {multiple\n          ? renderSelectMultiple({\n              commonInputProps,\n              onInnerClear,\n              popupVisible: visibleProps.visible,\n            })\n          : renderSelectSingle(visibleProps.visible)}\n      </Popup>\n    </div>\n  );\n\n  if (!props.tips) return mainContent;\n\n  return (\n    <div ref={selectInputWrapRef} className={`${prefix}-select-input__wrap`}>\n      {mainContent}\n      <div className={`${prefix}-input__tips ${prefix}-input__tips--${props.status || 'normal'}`}>{props.tips}</div>\n    </div>\n  );\n});\n\nSelectInput.displayName = 'SelectInput';\nSelectInput.defaultProps = selectInputDefaultProps;\n\nexport default SelectInput;\n"],"names":["SelectInput","forwardRef","props","ref","selectInputRef","useRef","selectInputWrapRef","useConfig","prefix","classPrefix","multiple","value","popupVisible","popupProps","borderless","disabled","useOverlayInnerStyle","tOverlayInnerStyle","innerPopupVisible","onInnerPopupVisibleChange","useSingle","commonInputProps","inputRef","onInnerClear","renderSelectSingle","useMultiple","tagInputRef","renderSelectMultiple","popupClasses","classNames","className","Array","length","useImperativeHandle","current","visibleProps","visible","mainContent","React","createElement","style","Popup","trigger","placement","content","panel","hideEmptyPopup","onVisibleChange","overlayInnerStyle","updateScrollTop","tips","status","displayName","defaultProps","selectInputDefaultProps"],"mappings":"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"}