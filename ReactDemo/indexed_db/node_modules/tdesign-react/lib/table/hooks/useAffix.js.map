{"version":3,"file":"useAffix.js","sources":["../../../src/table/hooks/useAffix.ts"],"sourcesContent":["import { useState, useRef, useMemo, useEffect } from 'react';\nimport { TdBaseTableProps } from '../type';\nimport { on, off } from '../../_util/dom';\nimport { AffixProps } from '../../affix';\n\n/**\n * 1. 表头吸顶（普通表头吸顶 和 虚拟滚动表头吸顶）\n * 2. 表尾吸底\n * 3. 底部滚动条吸底\n * 4. 分页器吸底\n */\nexport default function useAffix(props: TdBaseTableProps) {\n  const tableContentRef = useRef<HTMLDivElement>();\n  // 吸顶表头\n  const affixHeaderRef = useRef<HTMLDivElement>();\n  // 吸底表尾\n  const affixFooterRef = useRef<HTMLDivElement>();\n  // 吸底滚动条\n  const horizontalScrollbarRef = useRef<HTMLDivElement>();\n  // 吸底分页器\n  const paginationRef = useRef<HTMLDivElement>();\n  // 当表格完全滚动消失在视野时，需要隐藏吸顶表头\n  const [showAffixHeader, setShowAffixHeader] = useState(true);\n  // 当表格完全滚动消失在视野时，需要隐藏吸底尾部\n  const [showAffixFooter, setShowAffixFooter] = useState(true);\n  // 当表格完全滚动消失在视野时，需要隐藏吸底分页器\n  const [showAffixPagination, setShowAffixPagination] = useState(true);\n\n  const isVirtualScroll = useMemo(\n    () => props.scroll && props.scroll.type === 'virtual' && (props.scroll.threshold || 100) < props.data.length,\n    [props.data.length, props.scroll],\n  );\n\n  const isAffixed = useMemo(\n    () => !!(props.headerAffixedTop || props.footerAffixedBottom || props.horizontalScrollAffixedBottom),\n    [props.footerAffixedBottom, props.headerAffixedTop, props.horizontalScrollAffixedBottom],\n  );\n\n  let lastScrollLeft = 0;\n  const onHorizontalScroll = (scrollElement?: HTMLElement) => {\n    if (!isAffixed && !isVirtualScroll) return;\n    let target = scrollElement;\n    if (!target && tableContentRef.current) {\n      lastScrollLeft = 0;\n      target = tableContentRef.current;\n    }\n    if (!target) return;\n    const left = target.scrollLeft;\n    // 如果 lastScrollLeft 等于 left，说明不是横向滚动，不需要更新横向滚动距离\n    if (lastScrollLeft === left) return;\n    lastScrollLeft = left;\n    // 表格内容、吸顶表头、吸底表尾、吸底横向滚动更新\n    const toUpdateScrollElement = [\n      tableContentRef.current,\n      affixHeaderRef.current,\n      affixFooterRef.current,\n      horizontalScrollbarRef.current,\n    ];\n    for (let i = 0, len = toUpdateScrollElement.length; i < len; i++) {\n      if (toUpdateScrollElement[i] && scrollElement !== toUpdateScrollElement[i]) {\n        toUpdateScrollElement[i].scrollLeft = left;\n      }\n    }\n  };\n\n  // 吸底的元素（footer、横向滚动条、分页器）是否显示\n  const isAffixedBottomElementShow = (elementRect: DOMRect, tableRect: DOMRect, headerHeight: number) =>\n    tableRect.top + headerHeight < elementRect.top && elementRect.top > elementRect.height;\n\n  const getOffsetTop = (props: boolean | AffixProps) => {\n    if (typeof props === 'boolean') return 0;\n    return props.offsetTop || 0;\n  };\n\n  const updateAffixHeaderOrFooter = () => {\n    if (!isAffixed && !isVirtualScroll) return;\n    const pos = tableContentRef.current?.getBoundingClientRect();\n    const headerRect = tableContentRef.current?.querySelector('thead')?.getBoundingClientRect();\n    const headerHeight = headerRect.height || 0;\n    const footerRect = affixFooterRef.current?.getBoundingClientRect();\n    if ((props.headerAffixedTop || isVirtualScroll) && affixHeaderRef.current) {\n      const offsetTop = getOffsetTop(props.headerAffixProps || props.headerAffixedTop);\n      const footerHeight = footerRect?.height || 0;\n      let r = Math.abs(pos.top) < pos.height - headerHeight - offsetTop - footerHeight;\n      // 如果是虚拟滚动的表头，只要表头在可视区域内，一律永久显示（虚拟滚动表头 和 吸顶表头可能同时存在）\n      if (isVirtualScroll) {\n        r = pos.top > -1 * headerRect.height;\n      }\n      setShowAffixHeader(r);\n    }\n    // 底部内容吸底 和 底部滚动条吸底，不可能同时存在，二选一即可\n    if (props.footerAffixedBottom && affixFooterRef.current) {\n      const show = isAffixedBottomElementShow(footerRect, pos, headerHeight);\n      setShowAffixFooter(show);\n    } else if (props.horizontalScrollAffixedBottom && horizontalScrollbarRef.current) {\n      const horizontalScrollbarRect = horizontalScrollbarRef.current.getBoundingClientRect();\n      const show = isAffixedBottomElementShow(horizontalScrollbarRect, pos, headerHeight);\n      setShowAffixFooter(show);\n    }\n    if (props.paginationAffixedBottom && paginationRef.current) {\n      const pageRect = paginationRef.current.getBoundingClientRect();\n      const show = isAffixedBottomElementShow(pageRect, pos, headerHeight);\n      setShowAffixPagination(show);\n    }\n  };\n\n  const onDocumentScroll = () => {\n    updateAffixHeaderOrFooter();\n  };\n\n  const onFootScroll = () => {\n    onHorizontalScroll(affixFooterRef.current);\n  };\n\n  const onHeaderScroll = () => {\n    onHorizontalScroll(affixHeaderRef.current);\n  };\n\n  const horizontalScrollbarScroll = () => {\n    onHorizontalScroll(horizontalScrollbarRef.current);\n  };\n\n  const onTableContentScroll = () => {\n    onHorizontalScroll(tableContentRef.current);\n  };\n\n  const onFootMouseEnter = () => {\n    on(affixFooterRef.current, 'scroll', onFootScroll);\n  };\n\n  const onFootMouseLeave = () => {\n    off(affixFooterRef.current, 'scroll', onFootScroll);\n  };\n\n  const onHeaderMouseEnter = () => {\n    on(affixHeaderRef.current, 'scroll', onHeaderScroll);\n  };\n\n  const onHeaderMouseLeave = () => {\n    off(affixHeaderRef.current, 'scroll', onHeaderScroll);\n  };\n\n  const onScrollbarMouseEnter = () => {\n    on(horizontalScrollbarRef.current, 'scroll', horizontalScrollbarScroll);\n  };\n\n  const onScrollbarMouseLeave = () => {\n    off(horizontalScrollbarRef.current, 'scroll', horizontalScrollbarScroll);\n  };\n\n  const onTableContentMouseEnter = () => {\n    on(tableContentRef.current, 'scroll', onTableContentScroll);\n  };\n\n  const onTableContentMouseLeave = () => {\n    off(tableContentRef.current, 'scroll', onTableContentScroll);\n  };\n\n  const addHorizontalScrollListeners = () => {\n    if (affixHeaderRef.current) {\n      on(affixHeaderRef.current, 'mouseenter', onHeaderMouseEnter);\n      on(affixHeaderRef.current, 'mouseleave', onHeaderMouseLeave);\n    }\n\n    if (props.footerAffixedBottom && affixFooterRef.current) {\n      on(affixFooterRef.current, 'mouseenter', onFootMouseEnter);\n      on(affixFooterRef.current, 'mouseleave', onFootMouseLeave);\n    }\n\n    if (props.horizontalScrollAffixedBottom && horizontalScrollbarRef.current) {\n      on(horizontalScrollbarRef.current, 'mouseenter', onScrollbarMouseEnter);\n      on(horizontalScrollbarRef.current, 'mouseleave', onScrollbarMouseLeave);\n    }\n\n    if ((isAffixed || isVirtualScroll) && tableContentRef.current) {\n      on(tableContentRef.current, 'mouseenter', onTableContentMouseEnter);\n      on(tableContentRef.current, 'mouseleave', onTableContentMouseLeave);\n    }\n  };\n\n  const removeHorizontalScrollListeners = () => {\n    if (affixHeaderRef.current) {\n      off(affixHeaderRef.current, 'mouseenter', onHeaderMouseEnter);\n      off(affixHeaderRef.current, 'mouseleave', onHeaderMouseLeave);\n    }\n    if (affixFooterRef.current) {\n      off(affixFooterRef.current, 'mouseenter', onFootMouseEnter);\n      off(affixFooterRef.current, 'mouseleave', onFootMouseLeave);\n    }\n    if (tableContentRef.current) {\n      off(tableContentRef.current, 'mouseenter', onTableContentMouseEnter);\n      off(tableContentRef.current, 'mouseleave', onTableContentMouseLeave);\n    }\n    if (horizontalScrollbarRef.current) {\n      off(horizontalScrollbarRef.current, 'mouseenter', onScrollbarMouseEnter);\n      off(horizontalScrollbarRef.current, 'mouseleave', onScrollbarMouseLeave);\n    }\n  };\n\n  const addVerticalScrollListener = () => {\n    if (!isAffixed && !props.paginationAffixedBottom) return;\n    const timer = setTimeout(() => {\n      if (isAffixed || props.paginationAffixedBottom) {\n        on(document, 'scroll', onDocumentScroll);\n      } else {\n        off(document, 'scroll', onDocumentScroll);\n      }\n      clearTimeout(timer);\n    });\n  };\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      addHorizontalScrollListeners();\n      onHorizontalScroll();\n      updateAffixHeaderOrFooter();\n      clearTimeout(timer);\n    });\n\n    return removeHorizontalScrollListeners;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [affixHeaderRef, affixFooterRef, horizontalScrollbarRef, tableContentRef]);\n\n  useEffect(() => {\n    addVerticalScrollListener();\n    return () => {\n      off(document, 'scroll', onDocumentScroll);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isAffixed]);\n\n  useEffect(() => {\n    addHorizontalScrollListeners();\n    onHorizontalScroll();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    props.data,\n    props.columns,\n    props.headerAffixedTop,\n    props.footerAffixedBottom,\n    props.horizontalScrollAffixedBottom,\n  ]);\n\n  const setTableContentRef = (tableContent: HTMLDivElement) => {\n    tableContentRef.current = tableContent;\n    addVerticalScrollListener();\n  };\n\n  return {\n    showAffixHeader,\n    showAffixFooter,\n    showAffixPagination,\n    affixHeaderRef,\n    affixFooterRef,\n    horizontalScrollbarRef,\n    paginationRef,\n    onHorizontalScroll,\n    setTableContentRef,\n    updateAffixHeaderOrFooter,\n  };\n}\n"],"names":["useAffix","props","tableContentRef","useRef","affixHeaderRef","affixFooterRef","horizontalScrollbarRef","paginationRef","useState","showAffixHeader","setShowAffixHeader","showAffixFooter","setShowAffixFooter","showAffixPagination","setShowAffixPagination","isVirtualScroll","useMemo","scroll","type","threshold","data","length","isAffixed","headerAffixedTop","footerAffixedBottom","horizontalScrollAffixedBottom","lastScrollLeft","onHorizontalScroll","scrollElement","target","current","left","scrollLeft","toUpdateScrollElement","i","len","isAffixedBottomElementShow","elementRect","tableRect","headerHeight","top","height","getOffsetTop","offsetTop","updateAffixHeaderOrFooter","pos","getBoundingClientRect","headerRect","querySelector","footerRect","headerAffixProps","footerHeight","r","Math","abs","show","horizontalScrollbarRect","paginationAffixedBottom","pageRect","onDocumentScroll","onFootScroll","onHeaderScroll","horizontalScrollbarScroll","onTableContentScroll","onFootMouseEnter","on","onFootMouseLeave","off","onHeaderMouseEnter","onHeaderMouseLeave","onScrollbarMouseEnter","onScrollbarMouseLeave","onTableContentMouseEnter","onTableContentMouseLeave","addHorizontalScrollListeners","removeHorizontalScrollListeners","addVerticalScrollListener","timer","setTimeout","document","clearTimeout","useEffect","columns","setTableContentRef","tableContent"],"mappings":"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"}