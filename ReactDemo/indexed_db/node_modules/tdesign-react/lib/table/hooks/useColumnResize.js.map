{"version":3,"file":"useColumnResize.js","sources":["../../../src/table/hooks/useColumnResize.tsx"],"sourcesContent":["import { useState, useRef, MutableRefObject, CSSProperties } from 'react';\nimport isNumber from 'lodash/isNumber';\nimport { BaseTableCol, TableRowData } from '../type';\nimport { RecalculateColumnWidthFunc } from '../interface';\nimport setThWidthListByColumnDrag from '../../_common/js/table/set-column-width-by-drag';\nimport recalculateColumnWidth from '../../_common/js/table/recalculate-column-width';\n\nconst DEFAULT_MIN_WIDTH = 80;\nconst DEFAULT_MAX_WIDTH = 600;\n\nexport default function useColumnResize(\n  tableContentRef: MutableRefObject<HTMLDivElement>,\n  refreshTable: () => void,\n  getThWidthList: () => { [colKeys: string]: number },\n  updateThWidthList: (data: { [colKeys: string]: number }) => void,\n) {\n  const resizeLineRef = useRef<HTMLDivElement>();\n  const notCalculateWidthCols = useRef<string[]>([]);\n  const effectColMap = useRef<{ [colKey: string]: any }>({});\n\n  // 递归查找列宽度变化后，受影响的相关列\n  const setEffectColMap = (nodes: BaseTableCol<TableRowData>[], parent: BaseTableCol<TableRowData> | null) => {\n    if (!nodes) return;\n    nodes.forEach((n, index) => {\n      const parentPrevCol = parent ? effectColMap.current[parent.colKey].prev : nodes[index + 1];\n      const parentNextCol = parent ? effectColMap.current[parent.colKey].next : nodes[index - 1];\n      const prev = index === 0 ? parentPrevCol : nodes[index - 1];\n      const next = index === nodes.length - 1 ? parentNextCol : nodes[index + 1];\n      effectColMap.current[n.colKey] = {\n        prev,\n        next,\n      };\n      setEffectColMap(n.children, n);\n    });\n  };\n\n  const resizeLineParams = {\n    isDragging: false,\n    draggingCol: null as HTMLElement,\n    draggingStart: 0,\n    effectCol: null as 'next' | 'prev' | null,\n  };\n\n  const [resizeLineStyle, setResizeLineStyle] = useState<CSSProperties>({\n    display: 'none',\n    left: '10px',\n    height: '10px',\n    bottom: '0',\n  });\n\n  const setNotCalculateWidthCols = (colKeys: string[]) => {\n    notCalculateWidthCols.current = colKeys;\n  };\n\n  let resizeLineLeft = '';\n\n  // 表格列宽拖拽事件\n  // 只在表头显示拖拽图标\n  const onColumnMouseover = (e: MouseEvent) => {\n    if (!resizeLineRef.current) return;\n\n    const target = (e.target as HTMLElement).closest('th');\n    const targetBoundRect = target.getBoundingClientRect();\n    if (!resizeLineParams.isDragging) {\n      // 当离右边框的距离不超过 8 时，显示拖拽图标\n      const distance = 8;\n      if (targetBoundRect.right - e.pageX <= distance) {\n        target.style.cursor = 'col-resize';\n        resizeLineParams.draggingCol = target;\n        resizeLineParams.effectCol = 'next';\n      } else if (e.pageX - targetBoundRect.left <= distance) {\n        const prevEl = target.previousElementSibling;\n        if (prevEl) {\n          target.style.cursor = 'col-resize';\n          resizeLineParams.draggingCol = prevEl as HTMLElement;\n          resizeLineParams.effectCol = 'prev';\n        } else {\n          target.style.cursor = '';\n          resizeLineParams.draggingCol = null;\n          resizeLineParams.effectCol = null;\n        }\n      } else {\n        target.style.cursor = '';\n        resizeLineParams.draggingCol = null;\n        resizeLineParams.effectCol = null;\n      }\n    }\n  };\n\n  // 调整表格列宽\n  const onColumnMousedown = (e: MouseEvent, col: BaseTableCol<TableRowData>) => {\n    // 非 resize 的点击，不做处理\n    if (!resizeLineParams.draggingCol) return;\n\n    const getMinMaxColWidth = (col: BaseTableCol<TableRowData>, effectPrevCol: BaseTableCol<TableRowData>) => {\n      let targetCol = null;\n      if (resizeLineParams.effectCol === 'next') {\n        targetCol = col;\n      } else {\n        targetCol = effectPrevCol;\n      }\n      const propMinWidth = isNumber(targetCol.minWidth) ? targetCol.minWidth : parseFloat(targetCol.minWidth);\n      return {\n        minColWidth: Math.max(targetCol.resize?.minWidth || DEFAULT_MIN_WIDTH, propMinWidth || DEFAULT_MIN_WIDTH),\n        maxColWidth: targetCol.resize?.maxWidth || DEFAULT_MAX_WIDTH,\n      };\n    };\n\n    const target = resizeLineParams.draggingCol;\n    const targetBoundRect = target.getBoundingClientRect();\n    const tableBoundRect = tableContentRef.current?.getBoundingClientRect();\n    const resizeLinePos = targetBoundRect.right - tableBoundRect.left;\n    const colLeft = targetBoundRect.left - tableBoundRect.left;\n    const effectNextCol = effectColMap.current[col.colKey].next;\n    const effectPrevCol = effectColMap.current[col.colKey].prev;\n    const { minColWidth, maxColWidth } = getMinMaxColWidth(col, effectPrevCol);\n    const minResizeLineLeft = colLeft + minColWidth;\n    const maxResizeLineLeft = colLeft + maxColWidth;\n\n    // 开始拖拽，记录下鼠标起始位置\n    resizeLineParams.isDragging = true;\n    resizeLineParams.draggingStart = e.pageX || 0;\n\n    const parent = tableContentRef.current.parentElement.getBoundingClientRect();\n    const resizeLineBottom = `${parent.bottom - tableBoundRect.bottom}px`;\n\n    // 初始化 resizeLine 标记线\n    if (resizeLineRef?.current) {\n      setResizeLineStyle({\n        display: 'block',\n        left: `${resizeLinePos}px`,\n        height: `${tableBoundRect.bottom - targetBoundRect.top}px`,\n        bottom: resizeLineBottom,\n      });\n    }\n\n    const onDragOver: EventListener = (e: MouseEvent) => {\n      // 计算新的列宽，新列宽不得小于最小列宽\n      if (resizeLineParams.isDragging) {\n        const left = resizeLinePos + e.x - resizeLineParams.draggingStart;\n        const lineLeft = `${Math.min(Math.max(left, minResizeLineLeft), maxResizeLineLeft)}px`;\n        setResizeLineStyle({\n          display: 'block',\n          left: lineLeft,\n          height: `${tableBoundRect.bottom - targetBoundRect.top}px`,\n          bottom: resizeLineBottom,\n        });\n        resizeLineLeft = lineLeft;\n      }\n    };\n\n    // 拖拽时鼠标可能会超出 table 范围，需要给 document 绑定拖拽相关事件\n    const onDragEnd = () => {\n      if (resizeLineParams.isDragging) {\n        // 结束拖拽，更新列宽\n        let width = Math.ceil(parseInt(resizeLineLeft, 10) - colLeft) || 0;\n        // 为了避免精度问题，导致 width 宽度超出 [minColWidth, maxColWidth] 的范围，需要对比目标宽度和最小/最大宽度\n        if (width <= minColWidth) {\n          width = minColWidth;\n        } else if (width >= maxColWidth) {\n          width = maxColWidth;\n        }\n        // 更新列宽\n        if (resizeLineParams.effectCol === 'next') {\n          setThWidthListByColumnDrag<BaseTableCol<TableRowData>>(\n            col,\n            width,\n            effectNextCol,\n            { getThWidthList, DEFAULT_MIN_WIDTH },\n            (updateMap, notCalculateCols) => {\n              updateThWidthList(updateMap);\n              setNotCalculateWidthCols(notCalculateCols);\n            },\n          );\n        } else if (resizeLineParams.effectCol === 'prev') {\n          setThWidthListByColumnDrag<BaseTableCol<TableRowData>>(\n            effectPrevCol,\n            width,\n            col,\n            { getThWidthList, DEFAULT_MIN_WIDTH },\n            (updateMap, notCalculateCols) => {\n              updateThWidthList(updateMap);\n              setNotCalculateWidthCols(notCalculateCols);\n            },\n          );\n        }\n\n        // 恢复设置\n        resizeLineParams.isDragging = false;\n        resizeLineParams.draggingCol = null;\n        resizeLineParams.effectCol = null;\n        target.style.cursor = '';\n        setResizeLineStyle({\n          ...resizeLineStyle,\n          display: 'none',\n          left: '0',\n        });\n        document.removeEventListener('mousemove', onDragOver);\n        document.removeEventListener('mouseup', onDragEnd);\n        document.onselectstart = null;\n        document.ondragstart = null;\n      }\n\n      refreshTable();\n    };\n\n    document.addEventListener('mouseup', onDragEnd);\n    document.addEventListener('mousemove', onDragOver);\n\n    // 禁用鼠标的选中文字和拖放\n    document.onselectstart = () => false;\n    document.ondragstart = () => false;\n  };\n\n  const recalculateColWidth: RecalculateColumnWidthFunc = (\n    columns: BaseTableCol<TableRowData>[],\n    thWidthList: { [colKey: string]: number },\n    tableLayout: string,\n    tableElmWidth: number,\n  ): void => {\n    recalculateColumnWidth<BaseTableCol<TableRowData>>(\n      columns,\n      thWidthList,\n      tableLayout,\n      tableElmWidth,\n      notCalculateWidthCols.current,\n      (widthMap) => {\n        updateThWidthList(widthMap);\n        if (notCalculateWidthCols.current.length) {\n          notCalculateWidthCols.current = [];\n        }\n      },\n    );\n  };\n\n  return {\n    resizeLineRef,\n    resizeLineStyle,\n    onColumnMouseover,\n    onColumnMousedown,\n    recalculateColWidth,\n    setEffectColMap,\n  };\n}\n"],"names":["DEFAULT_MIN_WIDTH","DEFAULT_MAX_WIDTH","useColumnResize","tableContentRef","refreshTable","getThWidthList","updateThWidthList","resizeLineRef","useRef","notCalculateWidthCols","effectColMap","setEffectColMap","nodes","parent","forEach","n","index","parentPrevCol","current","colKey","prev","parentNextCol","next","length","children","resizeLineParams","isDragging","draggingCol","draggingStart","effectCol","useState","display","left","height","bottom","resizeLineStyle","setResizeLineStyle","setNotCalculateWidthCols","colKeys","resizeLineLeft","onColumnMouseover","e","target","closest","targetBoundRect","getBoundingClientRect","distance","right","pageX","style","cursor","prevEl","previousElementSibling","onColumnMousedown","col","getMinMaxColWidth","effectPrevCol","targetCol","propMinWidth","isNumber","minWidth","parseFloat","minColWidth","Math","max","resize","maxColWidth","maxWidth","tableBoundRect","resizeLinePos","colLeft","effectNextCol","minResizeLineLeft","maxResizeLineLeft","parentElement","resizeLineBottom","top","onDragOver","x","lineLeft","min","onDragEnd","width","ceil","parseInt","setThWidthListByColumnDrag","updateMap","notCalculateCols","document","removeEventListener","onselectstart","ondragstart","addEventListener","recalculateColWidth","columns","thWidthList","tableLayout","tableElmWidth","recalculateColumnWidth","widthMap"],"mappings":"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"}