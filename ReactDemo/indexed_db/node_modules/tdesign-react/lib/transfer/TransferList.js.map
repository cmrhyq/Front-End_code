{"version":3,"file":"TransferList.js","sources":["../../src/transfer/TransferList.tsx"],"sourcesContent":["import React, { useMemo, useState } from 'react';\nimport classnames from 'classnames';\nimport isFunction from 'lodash/isFunction';\nimport isEmpty from 'lodash/isEmpty';\nimport isString from 'lodash/isString';\nimport { SearchIcon as TdSearchIcon } from 'tdesign-icons-react';\nimport { getLeafNodes } from './utils';\nimport useConfig from '../hooks/useConfig';\nimport useGlobalIcon from '../hooks/useGlobalIcon';\nimport { TdTransferProps, TransferValue } from './type';\nimport { TNode, StyledProps } from '../common';\nimport Checkbox from '../checkbox';\nimport Input from '../input';\nimport Pagination, { PaginationProps } from '../pagination';\nimport { useLocaleReceiver } from '../locale/LocalReceiver';\n\ninterface TransferListProps\n  extends Pick<TdTransferProps, 'data' | 'search' | 'checked' | 'transferItem' | 'tree'>,\n    StyledProps {\n  disabled?: boolean;\n  empty?: TNode | string;\n  title?: TNode;\n  footer?: TNode;\n  content?: TNode;\n  pagination?: Pick<PaginationProps, 'pageSize'> & { onPageChange?: (current: number) => void };\n  onCheckbox?: (checked: Array<TransferValue>) => void;\n  onSearch?: (value: string) => void;\n  showCheckAll?: boolean;\n}\n\nconst TransferList: React.FunctionComponent<TransferListProps> = (props) => {\n  const {\n    className,\n    style,\n    data,\n    search = false,\n    checked = [],\n    empty,\n    title,\n    footer,\n    content,\n    onCheckbox,\n    onSearch,\n    disabled = false,\n    pagination,\n    transferItem,\n    tree: treeNode,\n    showCheckAll,\n  } = props;\n  const notDisabledData = !treeNode\n    ? data.filter((item) => !item.disabled)\n    : getLeafNodes(data).filter((item) => !item.disabled);\n  const [currentPage, setCurrentPage] = useState<number>(1);\n\n  const [indeterminate, allChecked] = useMemo(() => {\n    const activeLen = checked.length;\n    const notLen = notDisabledData.length;\n    return [activeLen && activeLen < notLen, activeLen && activeLen === notLen];\n  }, [checked, notDisabledData]);\n\n  const { classPrefix } = useConfig();\n  const { SearchIcon } = useGlobalIcon({\n    SearchIcon: TdSearchIcon,\n  });\n  const CLASSPREFIX = `${classPrefix}-transfer__list`;\n  const [local, t] = useLocaleReceiver('transfer');\n\n  const handleCheckbox = (vals: Array<TransferValue>) => {\n    if (isFunction(onCheckbox)) onCheckbox(vals);\n  };\n\n  const handleAllCheckbox = (checked: boolean) => {\n    if (isFunction(onCheckbox)) onCheckbox(checked ? notDisabledData.map((item) => item.value) : []);\n  };\n\n  const HeaderCmp = () => {\n    const total = treeNode ? getLeafNodes(data).length : data.length;\n    return (\n      <div className={`${CLASSPREFIX}-header`}>\n        <div>\n          {showCheckAll ? (\n            <Checkbox\n              indeterminate={indeterminate}\n              checked={allChecked}\n              disabled={disabled}\n              onChange={handleAllCheckbox}\n            />\n          ) : null}\n          <span>{t(local.title, { checked: checked.length, total })}</span>\n        </div>\n        <span>{title}</span>\n      </div>\n    );\n  };\n\n  const SearchCmp = () =>\n    search ? (\n      <div className={`${classPrefix}-transfer__search-wrapper`}>\n        <Input placeholder={local.placeholder} suffixIcon={<SearchIcon></SearchIcon>} onChange={onSearch}></Input>\n      </div>\n    ) : null;\n\n  const viewData = useMemo(() => {\n    if (!isEmpty(pagination)) {\n      const pageSize = pagination.pageSize || 10;\n      const start = (currentPage - 1) * pageSize;\n      return data.slice(start, start + pageSize);\n    }\n    return data;\n  }, [currentPage, data, pagination]);\n\n  const EmptyCmp = () =>\n    isString(empty) ? (\n      <div className={`${classPrefix}-transfer__empty`}>\n        <span>{empty || '暂无数据'}</span>\n      </div>\n    ) : (\n      empty\n    );\n\n  const contentCmp = () => {\n    if (typeof treeNode === 'function') {\n      return treeNode({ data: viewData, value: checked, onChange: handleCheckbox });\n    }\n    if (typeof content === 'function') {\n      return content({ data: viewData });\n    }\n    return (\n      <Checkbox.Group value={checked} onChange={handleCheckbox} disabled={disabled}>\n        {viewData.map((item, index) => (\n          <Checkbox key={item.value} value={item.value} disabled={item.disabled} className={`${CLASSPREFIX}-item`}>\n            <span>\n              {typeof transferItem === 'function' ? transferItem({ data: item, index, type: 'source' }) : item.label}\n            </span>\n          </Checkbox>\n        ))}\n      </Checkbox.Group>\n    );\n  };\n  const BodyCmp = () => (\n    <div\n      className={classnames(`${CLASSPREFIX}-body`, {\n        [`${CLASSPREFIX}--with-search`]: search,\n      })}\n    >\n      {SearchCmp()}\n      <div className={`${CLASSPREFIX}-content narrow-scrollbar`}>{viewData.length ? contentCmp() : EmptyCmp()}</div>\n    </div>\n  );\n\n  const PaginationCmp = () => {\n    const handleCurrentPagination = (current: number) => {\n      setCurrentPage(current);\n      if (isFunction(pagination.onPageChange)) {\n        pagination.onPageChange(current);\n      }\n    };\n\n    return pagination ? (\n      <div className={`${CLASSPREFIX}-pagination`}>\n        <Pagination\n          size=\"small\"\n          theme=\"simple\"\n          pageSizeOptions={[]}\n          total={data.length}\n          totalContent={false}\n          onCurrentChange={handleCurrentPagination}\n          pageSize={pagination.pageSize}\n        />\n      </div>\n    ) : null;\n  };\n\n  const footerCmp = () => (!isEmpty(footer) ? <div className={`${classPrefix}-transfer__footer`}>{footer}</div> : null);\n\n  return (\n    <div style={style} className={classnames(CLASSPREFIX, className)}>\n      {HeaderCmp()}\n      {BodyCmp()}\n      {PaginationCmp()}\n      {footerCmp()}\n    </div>\n  );\n};\n\nexport default TransferList;\n"],"names":["TransferList","props","className","style","data","search","checked","empty","title","footer","content","onCheckbox","onSearch","disabled","pagination","transferItem","treeNode","tree","showCheckAll","notDisabledData","filter","item","getLeafNodes","useState","currentPage","setCurrentPage","useMemo","activeLen","length","notLen","indeterminate","allChecked","useConfig","classPrefix","useGlobalIcon","SearchIcon","TdSearchIcon","CLASSPREFIX","useLocaleReceiver","local","t","handleCheckbox","vals","isFunction","handleAllCheckbox","map","value","HeaderCmp","total","React","createElement","Checkbox","onChange","SearchCmp","Input","placeholder","suffixIcon","viewData","isEmpty","pageSize","start","slice","EmptyCmp","isString","contentCmp","Group","index","key","type","label","BodyCmp","classnames","PaginationCmp","handleCurrentPagination","current","onPageChange","Pagination","size","theme","pageSizeOptions","totalContent","onCurrentChange","footerCmp"],"mappings":"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"}