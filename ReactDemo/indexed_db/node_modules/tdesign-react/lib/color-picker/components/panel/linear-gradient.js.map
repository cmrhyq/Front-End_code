{"version":3,"file":"linear-gradient.js","sources":["../../../../src/color-picker/components/panel/linear-gradient.tsx"],"sourcesContent":["import React, { KeyboardEvent, MouseEvent as ReactMouseEvent, useCallback, useEffect, useRef, useState } from 'react';\nimport cloneDeep from 'lodash/cloneDeep';\nimport classNames from 'classnames';\nimport useClassName from '../../hooks/useClassNames';\nimport { genGradientPoint, gradientColors2string } from '../../../_common/js/color-picker/color';\nimport { GradientColorPoint } from '../../../_common/js/color-picker/gradient';\nimport useCommonClassName from '../../../_util/useCommonClassName';\nimport { GRADIENT_SLIDER_DEFAULT_WIDTH } from '../../const';\nimport InputNumber from '../../../input-number';\n\nconst DELETE_KEYS: string[] = ['delete', 'backspace'];\n\ntype TSliderRect = {\n  left: number;\n  width: number;\n};\n\nconst LinearGradient = (props) => {\n  const { onChange, color, disabled } = props;\n  const baseClassName = useClassName();\n  const { STATUS: statusClassNames } = useCommonClassName();\n  const refSlider = useRef<HTMLDivElement>(null);\n  const sliderRectRef = useRef<TSliderRect>({\n    left: 0,\n    width: GRADIENT_SLIDER_DEFAULT_WIDTH,\n  });\n  const isDragging = useRef<Boolean>(false);\n  const isMoved = useRef<Boolean>(false);\n  const degree = useRef(props.color.gradientDegree);\n  const [selectedId, setSelectedId] = useState(props.color.gradientSelectedId);\n  const selectedRef = useRef(props.color.gradientSelectedId);\n  const colors = useRef<GradientColorPoint[]>(cloneDeep(color.gradientColors));\n\n  useEffect(() => {\n    degree.current = color?.gradientDegree;\n    setSelectedId(color.gradientSelectedId);\n    selectedRef.current = color.gradientSelectedId;\n    colors.current = cloneDeep(color.gradientColors);\n  }, [color]);\n\n  const updateSliderRect = () => {\n    const rect = refSlider.current.getBoundingClientRect();\n    sliderRectRef.current = {\n      left: rect.left,\n      width: rect.width || GRADIENT_SLIDER_DEFAULT_WIDTH,\n    };\n  };\n\n  const handleChange = useCallback(\n    (key: 'degree' | 'selectedId' | 'colors', payload: any, addUsedColor?: boolean) => {\n      if (disabled) {\n        return;\n      }\n      onChange({\n        key,\n        payload,\n        addUsedColor,\n      });\n    },\n    [onChange, disabled],\n  );\n\n  const handleDegreeChange = (value: number) => {\n    if (props.disabled || value === props.color.gradientDegree) {\n      return;\n    }\n    degree.current = value;\n    handleChange('degree', value, true);\n  };\n\n  const handleSelectedIdChange = (value: string) => {\n    if (props.disabled) {\n      return;\n    }\n    setSelectedId(value);\n    selectedRef.current = value;\n    handleChange('selectedId', value);\n  };\n\n  const handleColorsChange = useCallback(\n    (value: GradientColorPoint[], isEnded?: boolean) => {\n      if (props.disabled) {\n        return;\n      }\n      colors.current = value;\n      handleChange('colors', value, isEnded);\n    },\n    [props.disabled, handleChange],\n  );\n\n  /**\n   * 设置bar的位置\n   * @param left\n   * @returns\n   */\n  const updateActiveThumbLeft = useCallback(\n    (left: number) => {\n      const index = colors.current.findIndex((c) => c.id === selectedRef.current);\n      if (index === -1) {\n        return;\n      }\n      const point = colors.current[index];\n      const formatLeft = Math.max(0, Math.min(sliderRectRef.current.width, left));\n\n      const percentLeft = (formatLeft / sliderRectRef.current.width) * 100;\n\n      const newColors = colors.current.map((item, i) =>\n        index !== i\n          ? item\n          : {\n              color: point.color,\n              left: percentLeft,\n              id: point.id,\n            },\n      );\n\n      handleColorsChange(newColors);\n    },\n    [handleColorsChange],\n  );\n\n  // 移动开始\n  const handleStart = (id: string, e: ReactMouseEvent) => {\n    if (isDragging.current || props.disabled) {\n      return;\n    }\n    selectedRef.current = id;\n    setSelectedId(id);\n    isMoved.current = false;\n    isDragging.current = true;\n    e.preventDefault();\n    e.stopPropagation();\n    // handleSelectedIdChange(id);\n    // 让 slider 获取焦点，以便键盘事件生效。\n    refSlider.current.focus();\n  };\n\n  // 移动中\n  const handleMove = useCallback(\n    (e: MouseEvent) => {\n      if (!isDragging.current || disabled) {\n        return;\n      }\n\n      const rect = refSlider.current.getBoundingClientRect();\n      const left = e.clientX - rect.x;\n      isMoved.current = true;\n      updateActiveThumbLeft(left);\n    },\n    [disabled, updateActiveThumbLeft],\n  );\n\n  // 移动结束\n  const handleEnd = useCallback(() => {\n    if (!isDragging.current) {\n      return;\n    }\n    setTimeout(() => {\n      isDragging.current = false;\n    }, 0);\n    if (isMoved.current) {\n      handleColorsChange(colors.current, true);\n      isMoved.current = false;\n    }\n  }, [handleColorsChange]);\n\n  const handleKeyup = (e: KeyboardEvent) => {\n    if (props.disabled) {\n      return;\n    }\n    const points = [...colors.current];\n    let pos = points.findIndex((c) => c.id === selectedRef.current);\n    const { length } = points;\n    // 必须保证有两个点\n    if (DELETE_KEYS.includes(e.key.toLocaleLowerCase()) && length > 2 && pos >= 0 && pos <= length - 1) {\n      points.splice(pos, 1);\n      if (!points[pos]) {\n        // eslint-disable-next-line no-nested-ternary\n        pos = points[pos + 1] ? pos + 1 : points[pos - 1] ? pos - 1 : 0;\n      }\n      const current = points[pos];\n      handleColorsChange(points, true);\n      handleSelectedIdChange(current?.id);\n    }\n  };\n\n  const handleThumbBarClick = (e: ReactMouseEvent) => {\n    if (props.disabled) {\n      return;\n    }\n    updateSliderRect();\n\n    let left = e.clientX - sliderRectRef.current.left;\n    left = Math.max(0, Math.min(sliderRectRef.current.width, left));\n    const percentLeft = (left / sliderRectRef.current.width) * 100;\n\n    const newPoint = genGradientPoint(percentLeft, props.color.rgba);\n    const newColors = [...colors.current];\n    newColors.push(newPoint);\n    handleColorsChange(newColors, true);\n    handleSelectedIdChange(newPoint.id);\n  };\n\n  useEffect(() => {\n    updateSliderRect();\n\n    window.addEventListener('mousemove', handleMove, false);\n    window.addEventListener('mouseup', handleEnd, false);\n    window.addEventListener('contextmenu', handleEnd, false);\n\n    return () => {\n      window.removeEventListener('mousemove', handleMove, false);\n      window.removeEventListener('mouseup', handleEnd, false);\n      window.removeEventListener('contextmenu', handleEnd, false);\n    };\n    // eslint-disable-next-line\n  }, []);\n\n  const { gradientColors } = props.color;\n\n  const thumbBackground = gradientColors2string({\n    points: gradientColors,\n    degree: 90,\n  });\n\n  const handleClickThumb = (e: ReactMouseEvent, t) => {\n    handleSelectedIdChange(t.id);\n    e.stopPropagation();\n  };\n\n  const allGradientColors = [...colors.current];\n  const { color: leftColor } = genGradientPoint(0, allGradientColors[0]?.color);\n  const { color: rightColor } = genGradientPoint(100, allGradientColors[allGradientColors.length - 1]?.color);\n\n  return (\n    <div className={`${baseClassName}__gradient`}>\n      <div\n        className={`${baseClassName}__gradient-slider`}\n        style={{\n          background: `linear-gradient(90deg, ${leftColor} 0%, ${leftColor} 50%, ${rightColor} 50%, ${rightColor} 100%)`,\n        }}\n      >\n        <div\n          className={classNames(`${baseClassName}__slider`, `${baseClassName}--bg-alpha`)}\n          onKeyUp={handleKeyup}\n          tabIndex={0}\n          ref={refSlider}\n        >\n          <ul\n            className=\"gradient-thumbs\"\n            onClick={handleThumbBarClick}\n            style={{\n              background: thumbBackground,\n            }}\n          >\n            {colors.current.map((t) => {\n              const left = `${Math.round(t.left * 100) / 100}%`;\n              return (\n                <li\n                  className={classNames([\n                    `${baseClassName}__thumb`,\n                    'gradient-thumbs__item',\n                    selectedId === t.id ? statusClassNames.active : '',\n                  ])}\n                  key={t.id}\n                  title={`${t.color} ${left}`}\n                  style={{\n                    color: t.color,\n                    left,\n                  }}\n                  onClick={(e) => handleClickThumb(e, t)}\n                  onMouseDown={(e: ReactMouseEvent) => handleStart(t.id, e)}\n                >\n                  <span className={classNames(['gradient-thumbs__item-inner', `${baseClassName}--bg-alpha`])}></span>\n                </li>\n              );\n            })}\n          </ul>\n        </div>\n      </div>\n      <div className={`${baseClassName}__gradient-degree`} title={`${degree}deg`}>\n        <InputNumber\n          theme=\"normal\"\n          min={0}\n          max={360}\n          step={1}\n          size=\"small\"\n          format={(value: number) => `${value}°`}\n          value={degree.current}\n          onBlur={handleDegreeChange}\n          onEnter={handleDegreeChange}\n          disabled={props.disabled}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(LinearGradient);\n"],"names":["DELETE_KEYS","LinearGradient","props","onChange","color","disabled","baseClassName","useClassName","useCommonClassName","statusClassNames","STATUS","refSlider","useRef","sliderRectRef","left","width","GRADIENT_SLIDER_DEFAULT_WIDTH","isDragging","isMoved","degree","gradientDegree","useState","gradientSelectedId","selectedId","setSelectedId","selectedRef","colors","cloneDeep","gradientColors","useEffect","current","updateSliderRect","rect","getBoundingClientRect","handleChange","useCallback","key","payload","addUsedColor","handleDegreeChange","value","handleSelectedIdChange","handleColorsChange","isEnded","updateActiveThumbLeft","index","findIndex","c","id","point","formatLeft","Math","max","min","percentLeft","newColors","map","item","i","handleStart","e","preventDefault","stopPropagation","focus","handleMove","clientX","x","handleEnd","setTimeout","handleKeyup","points","pos","length","includes","toLocaleLowerCase","splice","handleThumbBarClick","newPoint","genGradientPoint","rgba","push","window","addEventListener","removeEventListener","thumbBackground","gradientColors2string","handleClickThumb","t","allGradientColors","leftColor","rightColor","React","createElement","className","style","background","classNames","onKeyUp","tabIndex","ref","onClick","round","active","title","onMouseDown","InputNumber","theme","step","size","format","onBlur","onEnter","memo"],"mappings":"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"}