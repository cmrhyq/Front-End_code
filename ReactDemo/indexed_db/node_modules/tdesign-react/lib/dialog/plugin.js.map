{"version":3,"file":"plugin.js","sources":["../../src/dialog/plugin.tsx"],"sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport DialogComponent, { DialogProps } from './Dialog';\n\nimport { getAttach } from '../_util/dom';\nimport { DialogOptions, DialogMethod, DialogConfirmMethod, DialogAlertMethod, DialogInstance } from './type';\nimport log from '../_common/js/log';\n\nexport interface DialogPluginType extends DialogMethod {\n  alert: DialogAlertMethod;\n  confirm: DialogConfirmMethod;\n}\n\nconst createDialog: DialogPluginType = (props: DialogOptions): DialogInstance => {\n  const dialogRef = React.createRef<DialogInstance>();\n  const options = { ...props };\n  const fragment = document.createDocumentFragment();\n\n  ReactDOM.render(\n    <DialogComponent {...(options as DialogProps)} visible={true} ref={dialogRef} isPlugin />,\n    fragment,\n    () => {\n      (document.activeElement as HTMLElement).blur();\n    },\n  );\n  const container = getAttach(options.attach);\n  if (container) {\n    container.appendChild(fragment);\n  } else {\n    log.error('Dialog', 'attach is not exist');\n  }\n\n  const dialogNode: DialogInstance = {\n    show: () => {\n      container.appendChild(fragment);\n      dialogRef.current?.show();\n    },\n    hide: () => {\n      dialogRef.current?.destroy();\n    },\n    update: (updateOptions: DialogOptions) => {\n      dialogRef.current?.update(updateOptions);\n    },\n    destroy: () => {\n      dialogRef.current?.destroy();\n    },\n  };\n  return dialogNode;\n};\n\nconst confirm: DialogConfirmMethod = (props: DialogOptions) => createDialog(props);\n\nconst alert: DialogAlertMethod = (props: Omit<DialogOptions, 'confirmBtn'>) => {\n  const options = { ...props };\n  options.cancelBtn = null;\n  return createDialog(options);\n};\n\ncreateDialog.alert = alert;\ncreateDialog.confirm = confirm;\n\nexport const DialogPlugin = createDialog;\n"],"names":["createDialog","props","dialogRef","React","createRef","options","fragment","document","createDocumentFragment","ReactDOM","render","createElement","DialogComponent","visible","ref","isPlugin","activeElement","blur","container","getAttach","attach","appendChild","log","error","dialogNode","show","current","hide","destroy","update","updateOptions","confirm","alert","cancelBtn","DialogPlugin"],"mappings":"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"}