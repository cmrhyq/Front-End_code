{"version":3,"file":"Drawer.js","sources":["../../src/drawer/Drawer.tsx"],"sourcesContent":["import React, { forwardRef, useState, useEffect, useImperativeHandle, useRef, useCallback } from 'react';\nimport classnames from 'classnames';\nimport { CloseIcon as TdCloseIcon } from 'tdesign-icons-react';\n\nimport { addClass, removeClass } from '../_util/dom';\nimport { useLocaleReceiver } from '../locale/LocalReceiver';\nimport getScrollbarWidth from '../_util/getScrollbarWidth';\nimport hasScrollBar from '../_util/hasScrollBar';\nimport { TdDrawerProps, DrawerEventSource } from './type';\nimport { StyledProps } from '../common';\nimport DrawerWrapper from './DrawerWrapper';\nimport Button from '../button';\nimport useConfig from '../hooks/useConfig';\nimport useGlobalIcon from '../hooks/useGlobalIcon';\nimport { drawerDefaultProps } from './defaultProps';\nimport useDrag from './hooks/useDrag';\n\nexport const CloseTriggerType: { [key: string]: DrawerEventSource } = {\n  CLICK_OVERLAY: 'overlay',\n  CLICK_CLOSE_BTN: 'close-btn',\n  CLICK_CANCEL_BTN: 'cancel',\n  KEYDOWN_ESC: 'esc',\n};\n\nexport interface DrawerProps extends TdDrawerProps, StyledProps {}\n\nconst Drawer = forwardRef((props: DrawerProps, ref: React.Ref<HTMLDivElement>) => {\n  const {\n    className,\n    style,\n    visible,\n    attach = '',\n    showOverlay,\n    size: propsSize,\n    placement,\n    onCancel,\n    onConfirm,\n    onClose,\n    onCloseBtnClick,\n    onOverlayClick,\n    onEscKeydown,\n    showInAttachedElement,\n    closeOnOverlayClick,\n    closeOnEscKeydown,\n    children,\n    header,\n    body,\n    footer,\n    closeBtn,\n    cancelBtn,\n    confirmBtn,\n    zIndex,\n    destroyOnClose,\n    mode,\n    preventScrollThrough = true,\n    sizeDraggable,\n  } = props;\n\n  // 国际化文本初始化\n  const [local, t] = useLocaleReceiver('drawer');\n  const { CloseIcon } = useGlobalIcon({ CloseIcon: TdCloseIcon });\n  const size = propsSize ?? local.size;\n  const confirmText = t(local.confirm);\n  const cancelText = t(local.cancel);\n\n  const { classPrefix } = useConfig();\n  const containerRef = useRef<HTMLDivElement>();\n  const contentWrapperRef = useRef<HTMLDivElement>();\n  const drawerWrapperRef = useRef<HTMLElement>(); // 即最终的 attach dom，默认为 document.body\n  const prefixCls = `${classPrefix}-drawer`;\n  const lockCls = `${prefixCls}--lock`;\n\n  const transform = visible ? 'translate(0px)' : '';\n  const closeIcon = React.isValidElement(closeBtn) ? closeBtn : <CloseIcon />;\n  const { dragSizeValue, enableDrag, draggableLineStyles } = useDrag(placement, sizeDraggable);\n  const [isDestroyOnClose, setIsDestroyOnClose] = useState(false);\n\n  useImperativeHandle(ref, () => containerRef.current);\n\n  useEffect(() => {\n    if (preventScrollThrough) {\n      if (visible && !showInAttachedElement) {\n        addClass(document.body, lockCls);\n      } else {\n        removeClass(document.body, lockCls);\n      }\n    }\n  }, [visible, showInAttachedElement, lockCls, preventScrollThrough]);\n\n  // 重置销毁钩子判断\n  useEffect(() => {\n    if (!destroyOnClose || !visible) return;\n    setIsDestroyOnClose(false);\n  }, [visible, destroyOnClose]);\n\n  const getSizeValue = useCallback(\n    (size: string): string => {\n      if (dragSizeValue) return dragSizeValue;\n\n      const defaultSize = isNaN(Number(size)) ? size : `${size}px`;\n      return (\n        {\n          small: '300px',\n          medium: '500px',\n          large: '760px',\n        }[size] || defaultSize\n      );\n    },\n    [dragSizeValue],\n  );\n\n  useEffect(() => {\n    let documentBodyCssText = '';\n\n    if (visible) {\n      if (attach !== '' && hasScrollBar()) {\n        // 处理滚动条宽度导致晃动的问题。\n        const scrollbarWidth = getScrollbarWidth();\n        documentBodyCssText = `overflow: hidden; width: calc(100% - ${scrollbarWidth}px);`;\n\n        if (mode !== 'push') {\n          // 这里做简单的性能优化，如果是 body 那么在下面 mode=push 的模式下，一起使用 cssText 设置，减少重绘重排\n          document.body.style.cssText = documentBodyCssText;\n        }\n      }\n    }\n\n    if (mode === 'push') {\n      drawerWrapperRef.current.style.cssText = 'transition: margin 300ms cubic-bezier(0.7, 0.3, 0.1, 1) 0s';\n\n      const marginStr = {\n        left: `margin: 0 0 0 ${getSizeValue(size)}`,\n        right: `margin: 0 0 0 -${getSizeValue(size)}`,\n        top: `margin: ${getSizeValue(size)} 0 0 0`,\n        bottom: `margin: -${getSizeValue(size)} 0 0 0`,\n      }[placement];\n\n      if (visible) {\n        drawerWrapperRef.current.style.cssText += marginStr;\n      } else {\n        drawerWrapperRef.current.style.cssText = drawerWrapperRef.current.style.cssText.replace(/margin:.+;/, '');\n      }\n    }\n\n    if (contentWrapperRef.current) {\n      // 聚焦到 Drawer 最外层元素即 containerRef.current，KeyDown 事件才有效。\n      containerRef.current.focus();\n\n      contentWrapperRef.current.style.transform = transform;\n    }\n  }, [attach, mode, transform, visible, placement, size, getSizeValue]);\n\n  function onMaskClick(e: React.MouseEvent<HTMLDivElement>) {\n    onOverlayClick?.({ e });\n    (closeOnOverlayClick ?? local.closeOnOverlayClick) && onClose?.({ e, trigger: CloseTriggerType.CLICK_OVERLAY });\n  }\n  function onClickCloseBtn(e: React.MouseEvent<HTMLDivElement>) {\n    onCloseBtnClick?.({ e });\n    onClose?.({ e, trigger: CloseTriggerType.CLICK_CLOSE_BTN });\n  }\n  function onKeyDownEsc(e: React.KeyboardEvent<HTMLDivElement>) {\n    if (e.key !== 'Escape') return;\n\n    onEscKeydown?.({ e });\n    (closeOnEscKeydown ?? local.closeOnEscKeydown) && onClose?.({ e, trigger: CloseTriggerType.KEYDOWN_ESC });\n  }\n  function onCancelClick(e: React.MouseEvent<HTMLButtonElement>) {\n    onCancel?.({ e });\n    onClose?.({ e, trigger: CloseTriggerType.CLICK_CANCEL_BTN });\n  }\n  function onConfirmClick(e: React.MouseEvent<HTMLButtonElement>) {\n    onConfirm?.({ e });\n  }\n\n  function onTransitionEnd() {\n    if (!visible) {\n      // 重置样式\n      document.body.style.display = 'none';\n      document.body.style.overflow = '';\n      document.body.style.width = '';\n      document.body.style.margin = '';\n      document.body.style.display = 'block';\n\n      destroyOnClose && setIsDestroyOnClose(true);\n    }\n  }\n\n  const drawerClass = classnames(prefixCls, className, `${prefixCls}--${placement}`, {\n    [`${prefixCls}--open`]: visible,\n    [`${prefixCls}--attach`]: showInAttachedElement,\n    [`${prefixCls}--without-mask`]: !showOverlay,\n  });\n\n  const contentWrapperClass = classnames(\n    `${prefixCls}__content-wrapper`,\n    `${prefixCls}__content-wrapper--${placement}`,\n  );\n\n  const getContentWrapperStyle = useCallback(\n    () => ({\n      transform: visible ? 'translateX(0)' : undefined,\n      width: ['left', 'right'].includes(placement) ? getSizeValue(size) : '',\n      height: ['top', 'bottom'].includes(placement) ? getSizeValue(size) : '',\n    }),\n    [visible, placement, size, getSizeValue],\n  );\n\n  const [contentWrapperStyle, setContentWrapperStyle] = useState(getContentWrapperStyle());\n\n  useEffect(() => {\n    setContentWrapperStyle(getContentWrapperStyle());\n  }, [getContentWrapperStyle]);\n\n  function getFooter(): React.ReactNode {\n    if (footer !== true) return footer;\n\n    const defaultCancelBtn = (\n      <Button theme=\"default\" onClick={onCancelClick} className={`${prefixCls}__cancel`}>\n        {cancelBtn && typeof cancelBtn === 'string' ? cancelBtn : cancelText}\n      </Button>\n    );\n\n    const defaultConfirmBtn = (\n      <Button theme=\"primary\" onClick={onConfirmClick} className={`${prefixCls}__confirm`}>\n        {confirmBtn && typeof confirmBtn === 'string' ? confirmBtn : confirmText}\n      </Button>\n    );\n\n    const renderCancelBtn = cancelBtn && React.isValidElement(cancelBtn) ? cancelBtn : defaultCancelBtn;\n    const renderConfirmBtn = confirmBtn && React.isValidElement(confirmBtn) ? confirmBtn : defaultConfirmBtn;\n\n    const footerStyle = {\n      display: 'flex',\n      justifyContent: placement === 'right' ? 'flex-start' : 'flex-end',\n    };\n\n    return (\n      <div style={footerStyle}>\n        {placement === 'right' && renderConfirmBtn}\n        {renderCancelBtn}\n        {placement !== 'right' && renderConfirmBtn}\n      </div>\n    );\n  }\n\n  const renderOverlay = showOverlay && <div className={`${prefixCls}__mask`} onClick={onMaskClick} />;\n  const renderCloseBtn = closeBtn && (\n    <div onClick={onClickCloseBtn} className={`${prefixCls}__close-btn`}>\n      {closeIcon}\n    </div>\n  );\n  const renderHeader = header && <div className={`${prefixCls}__header`}>{header}</div>;\n  const renderBody = <div className={`${prefixCls}__body`}>{body || children}</div>;\n  const renderFooter = footer && <div className={`${prefixCls}__footer`}>{getFooter()}</div>;\n\n  if (isDestroyOnClose && !visible) return null;\n\n  return (\n    <DrawerWrapper attach={attach} ref={drawerWrapperRef}>\n      <div\n        ref={containerRef}\n        className={drawerClass}\n        style={{ zIndex, ...style }}\n        tabIndex={-1} // https://stackoverflow.com/questions/43503964/onkeydown-event-not-working-on-divs-in-react\n        onKeyDown={onKeyDownEsc}\n        onTransitionEnd={onTransitionEnd}\n      >\n        {renderOverlay}\n        <div ref={contentWrapperRef} className={contentWrapperClass} style={contentWrapperStyle}>\n          {renderCloseBtn}\n          {renderHeader}\n          {renderBody}\n          {renderFooter}\n          {sizeDraggable && <div style={draggableLineStyles} onMouseDown={enableDrag}></div>}\n        </div>\n      </div>\n    </DrawerWrapper>\n  );\n});\n\nDrawer.displayName = 'Drawer';\nDrawer.defaultProps = drawerDefaultProps;\n\nexport default Drawer;\n"],"names":["CloseTriggerType","CLICK_OVERLAY","CLICK_CLOSE_BTN","CLICK_CANCEL_BTN","KEYDOWN_ESC","Drawer","forwardRef","props","ref","className","style","visible","attach","showOverlay","propsSize","size","placement","onCancel","onConfirm","onClose","onCloseBtnClick","onOverlayClick","onEscKeydown","showInAttachedElement","closeOnOverlayClick","closeOnEscKeydown","children","header","body","footer","closeBtn","cancelBtn","confirmBtn","zIndex","destroyOnClose","mode","preventScrollThrough","sizeDraggable","useLocaleReceiver","local","t","useGlobalIcon","CloseIcon","TdCloseIcon","confirmText","confirm","cancelText","cancel","useConfig","classPrefix","containerRef","useRef","contentWrapperRef","drawerWrapperRef","prefixCls","lockCls","transform","closeIcon","React","isValidElement","useDrag","dragSizeValue","enableDrag","draggableLineStyles","useState","isDestroyOnClose","setIsDestroyOnClose","useImperativeHandle","current","useEffect","addClass","document","removeClass","getSizeValue","useCallback","defaultSize","isNaN","Number","small","medium","large","documentBodyCssText","hasScrollBar","scrollbarWidth","getScrollbarWidth","cssText","marginStr","left","right","top","bottom","replace","focus","onMaskClick","e","trigger","onClickCloseBtn","onKeyDownEsc","key","onCancelClick","onConfirmClick","onTransitionEnd","display","overflow","width","margin","drawerClass","classnames","contentWrapperClass","getContentWrapperStyle","includes","height","contentWrapperStyle","setContentWrapperStyle","getFooter","defaultCancelBtn","createElement","Button","theme","onClick","defaultConfirmBtn","renderCancelBtn","renderConfirmBtn","footerStyle","justifyContent","renderOverlay","renderCloseBtn","renderHeader","renderBody","renderFooter","DrawerWrapper","tabIndex","onKeyDown","onMouseDown","displayName","defaultProps","drawerDefaultProps"],"mappings":"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"}