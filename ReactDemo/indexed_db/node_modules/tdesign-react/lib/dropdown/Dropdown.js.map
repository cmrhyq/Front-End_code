{"version":3,"file":"Dropdown.js","sources":["../../src/dropdown/Dropdown.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport classNames from 'classnames';\nimport omit from 'lodash/omit';\nimport { DropdownOption, TdDropdownProps } from './type';\nimport { StyledProps } from '../common';\nimport Popup, { PopupVisibleChangeContext } from '../popup';\nimport DropdownMenu from './DropdownMenu';\nimport DropdownItem from './DropdownItem';\nimport { dropdownDefaultProps } from './defaultProps';\n\nimport useConfig from '../hooks/useConfig';\nimport useDropdownOptions from './hooks/useDropdownOptions';\n\nexport interface DropdownProps extends TdDropdownProps, StyledProps {\n  children?: React.ReactNode;\n}\n\nconst Dropdown = (props: DropdownProps) => {\n  const {\n    popupProps = {},\n    disabled,\n    placement,\n    trigger,\n    className,\n    children,\n    hideAfterItemClick,\n    options: propsOptions,\n    style,\n  } = props;\n\n  const arrayChildren = React.Children.toArray(children);\n  const { classPrefix } = useConfig();\n  const [isPopupVisible, togglePopupVisible] = useState(false);\n  const dropdownClass = `${classPrefix}-dropdown`;\n\n  const options = useDropdownOptions(arrayChildren, propsOptions);\n\n  const handleMenuClick = (data: DropdownOption, context: { e: React.MouseEvent<HTMLDivElement, MouseEvent> }) => {\n    if (hideAfterItemClick) togglePopupVisible(false);\n    props?.onClick?.(data, context);\n  };\n\n  const handleVisibleChange = (visible: boolean, context: PopupVisibleChangeContext) => {\n    togglePopupVisible(visible);\n    popupProps?.onVisibleChange?.(visible, context);\n  };\n\n  const renderContent = <DropdownMenu {...props} options={options} onClick={handleMenuClick} />;\n\n  const popupParams = {\n    disabled,\n    placement,\n    trigger,\n    showArrow: false,\n    content: renderContent,\n    ...omit(popupProps, 'onVisibleChange'),\n    overlayInnerClassName: classNames(dropdownClass, className, popupProps?.overlayInnerClassName),\n    overlayInnerStyle: style,\n  };\n\n  return (\n    <Popup\n      expandAnimation={true}\n      destroyOnClose={true}\n      visible={isPopupVisible}\n      onVisibleChange={handleVisibleChange}\n      {...popupParams}\n    >\n      {arrayChildren?.[0]}\n    </Popup>\n  );\n};\n\nDropdown.DropdownItem = DropdownItem;\nDropdown.DropdownMenu = DropdownMenu;\n\nDropdown.displayName = 'Dropdown';\nDropdown.defaultProps = dropdownDefaultProps;\n\nexport default Dropdown;\n"],"names":["Dropdown","props","popupProps","disabled","placement","trigger","className","children","hideAfterItemClick","propsOptions","options","style","arrayChildren","React","Children","toArray","useConfig","classPrefix","useState","isPopupVisible","togglePopupVisible","dropdownClass","useDropdownOptions","handleMenuClick","data","context","onClick","handleVisibleChange","visible","onVisibleChange","renderContent","createElement","DropdownMenu","popupParams","showArrow","content","omit","overlayInnerClassName","classNames","overlayInnerStyle","Popup","expandAnimation","destroyOnClose","DropdownItem","displayName","defaultProps","dropdownDefaultProps"],"mappings":"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"}