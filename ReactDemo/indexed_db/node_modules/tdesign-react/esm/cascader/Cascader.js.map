{"version":3,"file":"Cascader.js","sources":["../../src/cascader/Cascader.tsx"],"sourcesContent":["import React, { useMemo } from 'react';\nimport classNames from 'classnames';\nimport pick from 'lodash/pick';\nimport omit from 'lodash/omit';\nimport Panel from './components/Panel';\nimport SelectInput from '../select-input';\nimport FakeArrow from '../common/FakeArrow';\n\nimport useConfig from '../hooks/useConfig';\nimport useCommonClassName from '../_util/useCommonClassName';\nimport { useLocaleReceiver } from '../locale/LocalReceiver';\n\nimport { CascaderValue, TdCascaderProps } from './interface';\nimport { closeIconClickEffect, handleRemoveTagEffect } from './core/effect';\nimport { getPanels, getSingleContent, getMultipleContent } from './core/helper';\nimport { getFakeArrowIconClass } from './core/className';\nimport { useCascaderContext } from './hooks';\n\nimport { cascaderDefaultProps } from './defaultProps';\nimport { StyledProps } from '../common';\n\nexport interface CascaderProps extends TdCascaderProps, StyledProps {}\n\nconst Cascader = (props: CascaderProps) => {\n  /**\n   * global user props, config, data\n   */\n  const { classPrefix } = useConfig();\n  const { STATUS } = useCommonClassName();\n  const [global] = useLocaleReceiver('cascader');\n  const COMPONENT_NAME = `${classPrefix}-cascader`;\n\n  // 拿到全局状态的上下文\n  const { cascaderContext, isFilterable } = useCascaderContext(props);\n\n  const displayValue = useMemo(\n    () => (props.multiple ? getMultipleContent(cascaderContext) : getSingleContent(cascaderContext)),\n    [props.multiple, cascaderContext],\n  );\n\n  const panels = useMemo(() => getPanels(cascaderContext.treeNodes), [cascaderContext]);\n\n  const inputPlaceholder = useMemo(\n    () =>\n      (cascaderContext.visible && !props.multiple && getSingleContent(cascaderContext)) ||\n      (props.placeholder ?? global.placeholder),\n    [props.placeholder, cascaderContext, props.multiple, global.placeholder],\n  );\n\n  const renderSuffixIcon = () => {\n    const { visible, disabled } = cascaderContext;\n    return (\n      <FakeArrow\n        overlayClassName={getFakeArrowIconClass(classPrefix, STATUS, cascaderContext)}\n        isActive={visible}\n        disabled={disabled}\n      />\n    );\n  };\n\n  const { setVisible, visible, inputVal, setInputVal } = cascaderContext;\n  return (\n    <SelectInput\n      className={classNames(COMPONENT_NAME, props.className)}\n      style={props.style}\n      value={displayValue}\n      inputValue={visible ? inputVal : ''}\n      popupVisible={visible}\n      allowInput={isFilterable}\n      minCollapsedNum={props.minCollapsedNum}\n      collapsedItems={props.collapsedItems as any}\n      readonly={props.readonly}\n      clearable={props.clearable}\n      placeholder={inputPlaceholder}\n      multiple={props.multiple}\n      loading={props.loading}\n      disabled={props.disabled}\n      status={props.status}\n      tips={props.tips}\n      suffixIcon={() => renderSuffixIcon()}\n      popupProps={{\n        ...props.popupProps,\n        overlayInnerStyle: panels.length && !props.loading ? { width: 'auto' } : {},\n        overlayClassName: [`${classPrefix}-cascader__popup`, props.popupProps?.overlayClassName],\n      }}\n      inputProps={{ size: props.size, ...(props.inputProps as TdCascaderProps['inputProps']) }}\n      tagInputProps={{\n        size: props.size,\n        ...(props.tagInputProps as TdCascaderProps['tagInputProps']),\n      }}\n      tagProps={{ ...(props.tagProps as TdCascaderProps['tagProps']) }}\n      onInputChange={(value, ctx) => {\n        if (!visible) return;\n        setInputVal(`${value}`);\n        props?.selectInputProps?.onInputChange?.(value, ctx);\n      }}\n      onTagChange={(val: CascaderValue, ctx) => {\n        if (ctx.trigger === 'enter') return;\n        handleRemoveTagEffect(cascaderContext, ctx.index, props.onRemove);\n        props?.selectInputProps?.onTagChange?.(val, ctx);\n      }}\n      onPopupVisibleChange={(val: boolean, context) => {\n        if (props.disabled) return;\n        setVisible(val, context);\n        props?.selectInputProps?.onPopupVisibleChange?.(val, context);\n      }}\n      onBlur={(val, context) => {\n        props.onBlur?.({\n          value: cascaderContext.value,\n          e: context.e,\n        });\n        props?.selectInputProps?.onBlur?.(val, context);\n      }}\n      onFocus={(val, context) => {\n        props.onFocus?.({\n          value: cascaderContext.value,\n          e: context.e,\n        });\n        props?.selectInputProps?.onFocus?.(val, context);\n      }}\n      onClear={(context) => {\n        closeIconClickEffect(cascaderContext);\n        props?.selectInputProps?.onClear?.(context);\n      }}\n      {...omit(props.selectInputProps, [\n        'onTagChange',\n        'onInputChange',\n        'onPopupVisibleChange',\n        'onBlur',\n        'onFocus',\n        'onClear',\n      ])}\n      panel={\n        <Panel\n          cascaderContext={cascaderContext}\n          {...pick(props, ['trigger', 'onChange', 'empty', 'loading', 'loadingText'])}\n        ></Panel>\n      }\n    />\n  );\n};\n\nCascader.displayName = 'Cascader';\nCascader.defaultProps = cascaderDefaultProps;\n\nexport default Cascader;\n"],"names":["Cascader","props","useConfig","classPrefix","useCommonClassName","STATUS","useLocaleReceiver","global","COMPONENT_NAME","useCascaderContext","cascaderContext","isFilterable","displayValue","useMemo","multiple","getMultipleContent","getSingleContent","panels","getPanels","treeNodes","inputPlaceholder","visible","placeholder","renderSuffixIcon","disabled","React","createElement","FakeArrow","overlayClassName","getFakeArrowIconClass","isActive","setVisible","inputVal","setInputVal","SelectInput","className","classNames","style","value","inputValue","popupVisible","allowInput","minCollapsedNum","collapsedItems","readonly","clearable","loading","status","tips","suffixIcon","popupProps","overlayInnerStyle","length","width","inputProps","size","tagInputProps","tagProps","onInputChange","ctx","selectInputProps","onTagChange","val","trigger","handleRemoveTagEffect","index","onRemove","onPopupVisibleChange","context","onBlur","e","onFocus","onClear","closeIconClickEffect","omit","panel","Panel","pick","displayName","defaultProps","cascaderDefaultProps"],"mappings":"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"}