{"version":3,"file":"useDisableDate.js","sources":["../../../src/date-picker/hooks/useDisableDate.ts"],"sourcesContent":["import dayjs from 'dayjs';\nimport isObject from 'lodash/isObject';\nimport type { TdDatePickerProps, TdDateRangePickerProps } from '../type';\n\nexport interface disableDateProps {\n  disableDate?: TdDatePickerProps['disableDate'] | TdDateRangePickerProps['disableDate'];\n  format?: TdDatePickerProps['format'];\n  mode?: TdDatePickerProps['mode'];\n  start?: Date;\n  end?: Date;\n}\n\nexport default function useDisableDate(props: disableDateProps) {\n  const { disableDate, format, mode, start, end } = props;\n\n  return {\n    disableDate: (value: Date) => !isEnabled({ disableDate, format, mode, value }),\n    minDate: isObject(disableDate) && 'before' in disableDate ? new Date(disableDate.before) : start,\n    maxDate: isObject(disableDate) && 'after' in disableDate ? new Date(disableDate.after) : end,\n  };\n}\n\nfunction isEnabled(props): boolean {\n  const { disableDate, value, format, mode } = props;\n\n  if (!disableDate) return true;\n\n  let isEnabled = true;\n  // 值类型为 Function 则表示返回值为 true 的日期会被禁用\n  if (typeof disableDate === 'function') {\n    return !disableDate(value);\n  }\n\n  // 禁用日期，示例：['A', 'B'] 表示日期 A 和日期 B 会被禁用。\n  if (Array.isArray(disableDate)) {\n    let isIncludes = false;\n    const formatedDisabledDate = disableDate.map((item: string) => dayjs(item, format));\n    formatedDisabledDate.forEach((item) => {\n      if (item.isSame(dayjs(value))) {\n        isIncludes = true;\n      }\n    });\n    return !isIncludes;\n  }\n\n  // { from: 'A', to: 'B' } 表示在 A 到 B 之间的日期会被禁用。\n  const { from, to, before, after } = disableDate;\n  if (from && to) {\n    const compareMin = dayjs(new Date(from));\n    const compareMax = dayjs(new Date(to));\n\n    return !dayjs(value).isBetween(compareMin, compareMax, mode, '[]');\n  }\n\n  const min = before ? new Date(before) : null;\n  const max = after ? new Date(after) : null;\n\n  // { before: 'A', after: 'B' } 表示在 A 之前和在 B 之后的日期都会被禁用。\n  if (max && min) {\n    const compareMin = dayjs(new Date(min));\n    const compareMax = dayjs(new Date(max));\n\n    isEnabled = dayjs(value).isBetween(compareMin, compareMax, mode, '[]');\n  } else if (min) {\n    const compareMin = dayjs(new Date(min));\n    isEnabled = !dayjs(value).isBefore(compareMin, mode);\n  } else if (max) {\n    const compareMax = dayjs(new Date(max));\n    isEnabled = !dayjs(value).isAfter(compareMax, mode);\n  }\n  return isEnabled;\n}\n"],"names":["useDisableDate","props","disableDate","format","mode","start","end","value","isEnabled","minDate","isObject","Date","before","maxDate","after","Array","isArray","isIncludes","formatedDisabledDate","map","item","dayjs","forEach","isSame","from","to","compareMin","compareMax","isBetween","min","max","isBefore","isAfter"],"mappings":"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"}