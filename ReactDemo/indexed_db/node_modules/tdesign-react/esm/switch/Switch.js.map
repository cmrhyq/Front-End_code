{"version":3,"file":"Switch.js","sources":["../../src/switch/Switch.tsx"],"sourcesContent":["import React, { forwardRef, useEffect, useState } from 'react';\nimport classNames from 'classnames';\nimport Loading from '../loading';\nimport useConfig from '../hooks/useConfig';\nimport { StyledProps } from '../common';\nimport useCommonClassName from '../_util/useCommonClassName';\nimport { TdSwitchProps } from './type';\nimport { switchDefaultProps } from './defaultProps';\nimport log from '../_common/js/log';\n\nexport type SwitchChangeEventHandler = (value: boolean, event: React.MouseEvent<HTMLButtonElement>) => void;\nexport type SwitchClickEventHandler = SwitchChangeEventHandler;\n\nexport interface SwitchProps extends TdSwitchProps, StyledProps {}\n\nconst Switch = forwardRef((props: SwitchProps, ref: React.Ref<HTMLButtonElement>) => {\n  const { classPrefix } = useConfig();\n  const { className, value, defaultValue, disabled, loading, size, label, customValue, onChange, ...restProps } = props;\n  const [activeValue = true, inactiveValue = false] = customValue || [];\n\n  const isControlled = typeof value !== 'undefined';\n  const initChecked = defaultValue === activeValue || value === activeValue;\n  const [innerChecked, setInnerChecked] = useState(initChecked);\n\n  function renderContent(checked: boolean) {\n    if (typeof label === 'function') return label({ value });\n\n    if (typeof label === 'string') return label;\n\n    if (Array.isArray(label)) {\n      const [activeContent = '', inactiveContent = ''] = label;\n      const content = checked ? activeContent : inactiveContent;\n\n      if (typeof content === 'function') return content();\n\n      return content;\n    }\n\n    return null;\n  }\n\n  function onInternalClick() {\n    if (disabled) return;\n\n    !isControlled && setInnerChecked(!innerChecked);\n\n    const changedValue = !innerChecked ? activeValue : inactiveValue;\n    onChange?.(changedValue);\n  }\n\n  useEffect(() => {\n    if (Array.isArray(customValue) && !customValue.includes(value)) {\n      log.error('Switch', `value is not in customValue: ${JSON.stringify(customValue)}`);\n    }\n    isControlled && setInnerChecked(value === activeValue);\n  }, [value, customValue, activeValue, isControlled]);\n\n  const { SIZE, STATUS } = useCommonClassName();\n  const switchClassName = classNames(\n    `${classPrefix}-switch`,\n    className,\n    {\n      [STATUS.checked]: innerChecked,\n      [STATUS.disabled]: disabled,\n      [STATUS.loading]: loading,\n    },\n    SIZE[size],\n  );\n\n  return (\n    <button\n      {...restProps}\n      type=\"button\"\n      role=\"switch\"\n      disabled={disabled || loading}\n      className={switchClassName}\n      ref={ref}\n      onClick={onInternalClick}\n    >\n      <span className={`${classPrefix}-switch__handle`}>{loading && <Loading loading={true} size=\"small\" />}</span>\n      <div className={`${classPrefix}-switch__content`}>{renderContent(innerChecked)}</div>\n    </button>\n  );\n});\n\nSwitch.displayName = 'Switch';\nSwitch.defaultProps = switchDefaultProps;\n\nexport default Switch;\n"],"names":["Switch","forwardRef","props","ref","useConfig","classPrefix","className","value","defaultValue","disabled","loading","size","label","customValue","onChange","restProps","activeValue","inactiveValue","isControlled","initChecked","useState","innerChecked","setInnerChecked","renderContent","checked","Array","isArray","activeContent","inactiveContent","content","onInternalClick","changedValue","useEffect","includes","log","error","JSON","stringify","useCommonClassName","SIZE","STATUS","switchClassName","classNames","React","createElement","type","role","onClick","Loading","displayName","defaultProps","switchDefaultProps"],"mappings":"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"}