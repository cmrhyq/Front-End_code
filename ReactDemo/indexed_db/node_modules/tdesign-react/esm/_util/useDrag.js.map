{"version":3,"file":"useDrag.js","sources":["../../src/_util/useDrag.ts"],"sourcesContent":["import { useRef, useEffect } from 'react';\n\nexport interface Coordinate {\n  x: number;\n  y: number;\n}\n\ninterface DraggableCallback {\n  (coordinate: Coordinate, event?: MouseEvent): void;\n}\n\ninterface DraggableProps {\n  start?: DraggableCallback;\n  drag?: DraggableCallback;\n  end?: DraggableCallback;\n}\n\nconst useDrag = (ref, options: DraggableProps) => {\n  const { start, end, drag } = options;\n\n  const isDraggingRef = useRef(false);\n\n  const getCoordinate = (event: MouseEvent) => {\n    try {\n      const rect = ref.current?.getBoundingClientRect();\n      const left = event.clientX - rect.left;\n      const top = event.clientY - rect.top;\n      return {\n        y: Math.min(Math.max(0, top), rect.height),\n        x: Math.min(Math.max(0, left), rect.width),\n      };\n    } catch (error) {\n      return {\n        y: null,\n        x: null,\n      };\n    }\n  };\n\n  const handlePointerMove = (e: MouseEvent) => {\n    if (isDraggingRef.current) drag(getCoordinate(e), e);\n  };\n\n  const handlePointerUp = (e: MouseEvent) => {\n    isDraggingRef.current = false;\n    end(getCoordinate(e), e);\n    window.removeEventListener('mouseup', handlePointerUp);\n    window.removeEventListener('mousemove', handlePointerMove);\n  };\n\n  const handlePointerDown = (e: MouseEvent) => {\n    isDraggingRef.current = true;\n    start(getCoordinate(e), e);\n    window.addEventListener('mouseup', handlePointerUp);\n    window.addEventListener('mousemove', handlePointerMove);\n  };\n\n  useEffect(() => {\n    const element = ref.current;\n    if (element) {\n      element.addEventListener('mousedown', handlePointerDown);\n    }\n    return () => {\n      if (element) {\n        element.removeEventListener('mousedown', handlePointerDown);\n      }\n      window.removeEventListener('mouseup', handlePointerUp);\n      window.removeEventListener('mousemove', handlePointerMove);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return {\n    isDragging: isDraggingRef.current,\n  };\n};\n\nexport default useDrag;\n"],"names":["useDrag","ref","options","start","end","drag","isDraggingRef","useRef","getCoordinate","event","rect","current","getBoundingClientRect","left","clientX","top","clientY","y","Math","min","max","height","x","width","error","handlePointerMove","e","handlePointerUp","window","removeEventListener","handlePointerDown","addEventListener","useEffect","element","isDragging"],"mappings":"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"}