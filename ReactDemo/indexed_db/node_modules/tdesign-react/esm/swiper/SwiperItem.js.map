{"version":3,"file":"SwiperItem.js","sources":["../../src/swiper/SwiperItem.tsx"],"sourcesContent":["import React from 'react';\nimport classnames from 'classnames';\nimport useConfig from '../hooks/useConfig';\nimport { SwiperProps } from './Swiper';\n\nexport interface SwiperItemProps extends SwiperProps {\n  currentIndex?: number;\n  index?: number;\n  needAnimation?: boolean;\n  childrenLength?: number;\n  getWrapAttribute?: (attr: string) => number;\n}\n\nconst CARD_SCALE = 210 / 332; // 缩放比例\nconst itemWidth = 0.415; // 依据设计稿使用t-swiper__card控制每个swiper的宽度为41.5%\n\nconst disposeIndex = (index: number, currentIndex: number, childrenLength: number) => {\n  if (currentIndex === 0 && index === childrenLength - 1) {\n    return -1;\n  }\n  if (currentIndex === childrenLength - 1 && index === 0) {\n    return childrenLength;\n  }\n  if (index < currentIndex - 1 && currentIndex - index >= childrenLength / 2) {\n    return childrenLength + 1;\n  }\n  if (index > currentIndex + 1 && index - currentIndex >= childrenLength / 2) {\n    return -2;\n  }\n\n  return index;\n};\n\nconst calculateTranslate = (index: number, currentIndex: number, parentWidth: number, inStage: boolean) => {\n  if (inStage) {\n    return (parentWidth * ((index - currentIndex) * (1 - itemWidth * CARD_SCALE) - itemWidth + 1)) / 2;\n  }\n  if (index < currentIndex) {\n    return (-itemWidth * (1 + CARD_SCALE) * parentWidth) / 2;\n  }\n  return ((2 + itemWidth * (CARD_SCALE - 1)) * parentWidth) / 2;\n};\n\nconst getZindex = (isActivity, inStage) => {\n  if (isActivity) {\n    return 2;\n  }\n  if (inStage) {\n    return 1;\n  }\n  return 0;\n};\n\nconst SwiperItem = (props: SwiperItemProps) => {\n  const {\n    children,\n    currentIndex,\n    index,\n    animation,\n    duration = 300,\n    needAnimation,\n    type = 'default',\n    childrenLength,\n    getWrapAttribute,\n  } = props;\n  const { classPrefix } = useConfig();\n\n  const getSwiperItemStyle = () => {\n    if (animation === 'fade') {\n      return {\n        opacity: currentIndex === index ? 1 : 0,\n        transition: needAnimation ? `opacity ${duration / 1000}s` : '',\n      };\n    }\n    if (type === 'card') {\n      const wrapWidth = getWrapAttribute('offsetWidth');\n      const translateIndex =\n        index !== currentIndex && childrenLength > 2 ? disposeIndex(index, currentIndex, childrenLength) : index;\n      const inStage = Math.round(Math.abs(translateIndex - currentIndex)) <= 1;\n      const translate = calculateTranslate(translateIndex, currentIndex, wrapWidth, inStage).toFixed(2);\n      const isActivity = translateIndex === currentIndex;\n      const zIndex = getZindex(isActivity, inStage);\n      return {\n        msTransform: `translateX(${translate}px) scale(${isActivity ? 1 : CARD_SCALE})`,\n        WebkitTransform: `translateX(${translate}px) scale(${isActivity ? 1 : CARD_SCALE})`,\n        transform: `translateX(${translate}px) scale(${isActivity ? 1 : CARD_SCALE})`,\n        transition: `transform ${duration / 1000}s ease`,\n        zIndex,\n      };\n    }\n    return {};\n  };\n\n  return (\n    <div\n      className={classnames(`${classPrefix}-swiper__container__item`, {\n        [`${classPrefix}-swiper__card`]: type === 'card',\n        [`${classPrefix}-is-active`]: type === 'card' && index === currentIndex,\n        [`${classPrefix}-swiper__fade`]: animation === 'fade',\n      })}\n      style={getSwiperItemStyle()}\n    >\n      {children}\n    </div>\n  );\n};\n\nSwiperItem.displayName = 'SwiperItem';\n\nexport default SwiperItem;\n"],"names":["CARD_SCALE","itemWidth","disposeIndex","index","currentIndex","childrenLength","calculateTranslate","parentWidth","inStage","getZindex","isActivity","SwiperItem","props","children","animation","duration","needAnimation","type","getWrapAttribute","useConfig","classPrefix","getSwiperItemStyle","opacity","transition","wrapWidth","translateIndex","Math","round","abs","translate","toFixed","zIndex","msTransform","WebkitTransform","transform","React","createElement","className","classnames","style","displayName"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAaA,IAAMA,aAAa,GAAA,GAAM,GAAzB,CAAA;AACA,IAAMC,SAAY,GAAA,KAAlB,CAAA;;AAEA,IAAMC,YAAe,GAAA,SAAfA,YAAe,CAACC,KAAD,EAAgBC,YAAhB,EAAsCC,cAAtC,EAAiE;EACpF,IAAID,YAAiB,KAAA,CAAjB,IAAsBD,KAAU,KAAAE,cAAA,GAAiB,CAArD,EAAwD;AAC/C,IAAA,OAAA,CAAA,CAAA,CAAA;AACT,GAAA;;EACA,IAAID,YAAiB,KAAAC,cAAA,GAAiB,CAAlC,IAAuCF,KAAA,KAAU,CAArD,EAAwD;AAC/C,IAAA,OAAAE,cAAA,CAAA;AACT,GAAA;;AACA,EAAA,IAAIF,QAAQC,YAAe,GAAA,CAAvB,IAA4BA,YAAe,GAAAD,KAAf,IAAwBE,iBAAiB,CAAzE,EAA4E;IAC1E,OAAOA,cAAiB,GAAA,CAAxB,CAAA;AACF,GAAA;;AACA,EAAA,IAAIF,QAAQC,YAAe,GAAA,CAAvB,IAA4BD,KAAQ,GAAAC,YAAR,IAAwBC,iBAAiB,CAAzE,EAA4E;AACnE,IAAA,OAAA,CAAA,CAAA,CAAA;AACT,GAAA;;AAEO,EAAA,OAAAF,KAAA,CAAA;AACT,CAfA,CAAA;;AAiBA,IAAMG,kBAAqB,GAAA,SAArBA,kBAAqB,CAACH,KAAD,EAAgBC,YAAhB,EAAsCG,WAAtC,EAA2DC,OAA3D,EAAgF;AACzG,EAAA,IAAIA,OAAJ,EAAa;AACX,IAAA,OAAQD,gBAAgBJ,KAAQ,GAAAC,iBAAiB,CAAA,GAAIH,SAAY,GAAAD,WAAcC,GAAAA,YAAY,EAAnF,GAAyF,CAAjG,CAAA;AACF,GAAA;;EACA,IAAIE,QAAQC,YAAZ,EAA0B;IACxB,OAAQ,CAACH,SAAD,IAAc,CAAA,GAAID,UAAlB,CAAgCO,GAAAA,WAAhC,GAA+C,CAAvD,CAAA;AACF,GAAA;;EACA,OAAA,CAAS,CAAIN,GAAAA,SAAA,IAAaD,UAAa,GAAA,CAA1B,CAAb,IAA6CO,WAA7C,GAA4D,CAA5D,CAAA;AACF,CARA,CAAA;;AAUA,IAAME,SAAA,GAAY,SAAZA,SAAY,CAACC,UAAD,EAAaF,OAAb,EAAyB;AACzC,EAAA,IAAIE,UAAJ,EAAgB;AACP,IAAA,OAAA,CAAA,CAAA;AACT,GAAA;;AACA,EAAA,IAAIF,OAAJ,EAAa;AACJ,IAAA,OAAA,CAAA,CAAA;AACT,GAAA;;AACO,EAAA,OAAA,CAAA,CAAA;AACT,CARA,CAAA;;AAUA,IAAMG,UAAA,GAAa,SAAbA,UAAa,CAACC,KAAD,EAA4B;AAAA,EAAA,IAAA,WAAA,CAAA;;AACvC,EAAA,IACJC,QADI,GAUFD,KAVE,CACJC,QADI;AAAA,MAEJT,YAFI,GAUFQ,KAVE,CAEJR,YAFI;AAAA,MAGJD,KAHI,GAUFS,KAVE,CAGJT,KAHI;AAAA,MAIJW,SAJI,GAUFF,KAVE,CAIJE,SAJI;MAUFF,eAAAA,GAAAA,KAVE,CAKJG,QALI;MAKJA,QALI,gCAKO,GALP,GAAA,eAAA;AAAA,MAMJC,aANI,GAUFJ,KAVE,CAMJI,aANI;MAUFJ,WAAAA,GAAAA,KAVE,CAOJK,IAPI;MAOJA,IAPI,4BAOG,SAPH,GAAA,WAAA;AAAA,MAQJZ,cARI,GAUFO,KAVE,CAQJP,cARI;AAAA,MASJa,gBATI,GAUFN,KAVE,CASJM,gBATI,CAAA;;AAWA,EAAA,IAAA,UAAA,GAAkBC,SAAU,EAA5B;MAAEC,WAAF,cAAEA,WAAF,CAAA;;AAEN,EAAA,IAAMC,qBAAqB,SAArBA,kBAAqB,GAAM;IAC/B,IAAIP,cAAc,MAAlB,EAA0B;MACjB,OAAA;AACLQ,QAAAA,OAAA,EAASlB,YAAiB,KAAAD,KAAjB,GAAyB,CAAzB,GAA6B,CADjC;AAELoB,QAAAA,UAAY,EAAAP,aAAA,GAAA,UAAA,CAAA,MAAA,CAA2BD,QAAA,GAAW,GAAtC,EAAgD,GAAA,CAAA,GAAA,EAAA;OAFvD,CAAA;AAIT,KAAA;;IACA,IAAIE,SAAS,MAAb,EAAqB;AACb,MAAA,IAAAO,SAAA,GAAYN,iBAAiB,cAA7B,CAAA;AACA,MAAA,IAAAO,cAAA,GACJtB,UAAUC,YAAV,IAA0BC,cAAA,GAAiB,CAA3C,GAA+CH,YAAa,CAAAC,KAAA,EAAOC,YAAP,EAAqBC,cAArB,CAA5D,GAAmGF,KAD/F,CAAA;AAEA,MAAA,IAAAK,OAAA,GAAUkB,KAAKC,KAAL,CAAWD,IAAA,CAAKE,GAAL,CAASH,cAAiB,GAAArB,YAA1B,CAAX,KAAuD,CAAjE,CAAA;AACA,MAAA,IAAAyB,SAAA,GAAYvB,mBAAmBmB,gBAAgBrB,cAAcoB,WAAWhB,QAA5D,CAAqEsB,OAArE,CAA6E,CAA7E,CAAZ,CAAA;AACN,MAAA,IAAMpB,aAAae,cAAmB,KAAArB,YAAtC,CAAA;AACM,MAAA,IAAA2B,MAAA,GAAStB,SAAU,CAAAC,UAAA,EAAYF,OAAZ,CAAnB,CAAA;MACC,OAAA;QACLwB,WAAa,EAAA,aAAA,CAAA,MAAA,CAAcH,SAAd,EAAoCnB,YAAAA,CAAAA,CAAAA,MAAAA,CAAAA,UAAA,GAAa,CAAb,GAAiBV,UAArD,EADR,GAAA,CAAA;QAELiC,eAAiB,EAAA,aAAA,CAAA,MAAA,CAAcJ,SAAd,EAAoCnB,YAAAA,CAAAA,CAAAA,MAAAA,CAAAA,UAAA,GAAa,CAAb,GAAiBV,UAArD,EAFZ,GAAA,CAAA;QAGLkC,SAAW,EAAA,aAAA,CAAA,MAAA,CAAcL,SAAd,EAAoCnB,YAAAA,CAAAA,CAAAA,MAAAA,CAAAA,UAAA,GAAa,CAAb,GAAiBV,UAArD,EAHN,GAAA,CAAA;AAILuB,QAAAA,UAAA,EAAyBR,YAAAA,CAAAA,MAAAA,CAAAA,QAAW,GAAA,GAApC,EAJK,QAAA,CAAA;AAKLgB,QAAAA,MAAA,EAAAA,MAAAA;OALK,CAAA;AAOT,KAAA;;AACA,IAAA,OAAO,EAAP,CAAA;GAvBF,CAAA;;AA0BA,EAAA,sBACGI,KAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;IACCC,SAAA,EAAWC,UAAW,CAAA,EAAA,CAAA,MAAA,CAAGlB,WAAH,EAAA,0BAAA,CAAA,GAAA,WAAA,GAAA,EAAA,EAAA,eAAA,CAAA,WAAA,EAAA,EAAA,CAAA,MAAA,CAChBA,WADgB,EAAA,eAAA,CAAA,EACaH,IAAS,KAAA,MADtB,CAAA,EAAA,eAAA,CAAA,WAAA,EAAA,EAAA,CAAA,MAAA,CAEhBG,WAFgB,EAAA,YAAA,CAAA,EAEUH,IAAA,KAAS,MAAT,IAAmBd,KAAU,KAAAC,YAFvC,CAGhBgB,EAAAA,eAAAA,CAAAA,WAAAA,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,WAHgB,EAGaN,eAAAA,CAAAA,EAAAA,SAAc,KAAA,MAH3B,CADvB,EAAA,WAAA,EAAA;AAMCyB,IAAAA,OAAOlB,kBAAmB,EAAA;GAN3B,EAQER,QARF,CADH,CAAA;AAYF,EApDA;;AAsDAF,UAAA,CAAW6B,WAAX,GAAyB,YAAzB;;;;"}